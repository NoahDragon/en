<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
    
    <entry>
      <title><![CDATA[P2P Lending on GCE]]></title>
      <url>https://en.abnerchou.me/Blog/7cfc7701/</url>
      <content type="html"><![CDATA[<p>Recently, one of my friend reaching out to me regarding how to install the <a href="https://github.com/adorsys/p2p-lending" target="_blank" rel="noopener">P2P-Lending</a> on a GCE instance.
Well, the repo is old and haven’t updated for more than 3 years.
So I have overcome many difficulties to manage run it in a GCE instance.
Here are the steps:</p>
<ol>
<li>Create GCE instances with allow HTTP traffic (using defaul Debian image if using other Linux distros the following preparation may not fit).</li>
<li>Install NodeJs, followed steps in: <a href="https://cloud.google.com/nodejs/docs/setup" target="_blank" rel="noopener">https://cloud.google.com/nodejs/docs/setup</a><pre><code>curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.1/install.sh | bash
export NVM_DIR=&quot;$([ -z &quot;${XDG_CONFIG_HOME-}&quot; ] &amp;&amp; printf %s &quot;${HOME}/.nvm&quot; || printf %s &quot;${XDG_CONFIG_HOME}/nvm&quot;)&quot;
[ -s &quot;$NVM_DIR/nvm.sh&quot; ] &amp;&amp; \. &quot;$NVM_DIR/nvm.sh&quot; # This loads nvm
nvm install --lts
nvm use --lts
</code></pre></li>
<li>Install npm/git/python2 via command (for build-in python3 please ensure it &gt;= 3.6 or upgrade to the latest): <pre><code>sudo apt install git build-essential python
npm install -g npm
</code></pre></li>
<li>To avoid permission denied issue when calling the npm installed global package, please follow this link to resolve it:<pre><code> mkdir ~/.npm-global
 npm config set prefix &#39;~/.npm-global&#39;
 export PATH=~/.npm-global/bin:$PATH
 source ~/.profile
</code></pre></li>
<li>Install Ganache via command: <code>npm install ganache -g</code></li>
<li>Install Truffle via command: <code>npm install truffle -g</code></li>
<li>Clone the repo: <code>git clone https://github.com/adorsys/p2p-lending.git</code></li>
<li>Start Ganache with port 8545: <code>ganache -p 8545 &amp;</code></li>
<li>Go to p2p-lending folder, and delete the packge-lock.json file (force to pull the latest packages):<pre><code>cd p2p-lending
rm package-lock.json
npm install
truffle compile
npm run migrate:dev
</code></pre></li>
<li>[Optional] Set python executable, require python2 if not installed: <code>npm config set /usr/bin/python</code></li>
<li>In frontend folder, modify package.json, change the package web version from “1.0.0-beta.37” to “^1.0.0”. Then follow commands to install:<pre><code>cd frontend
npm uninstall node-sass
npm i -D sass
rm -rf node_modules package-lock.json &amp;&amp; npm install
</code></pre></li>
<li>Start the serve: <code>npm start</code></li>
</ol>
<p>That’s it. Hope it could provide some insights when you try to use the P2P-Lending, but strongly not recommended.
Since I’m not familar with blockchain, so not sure if there is any alternative to the P2P-Lending.
If anyone knows, please share in the comments. I will let my friend know.
Thanks in advance.</p>
]]></content>
      
        <categories>
            
            <category> Cloud </category>
            
        </categories>
        
        
        <tags>
            
            <tag> GCP </tag>
            
            <tag> Google Cloud </tag>
            
            <tag> GCE </tag>
            
            <tag> P2P </tag>
            
            <tag> Block Chain </tag>
            
            <tag> Computer Engine </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Cloud Functions VS Lambda]]></title>
      <url>https://en.abnerchou.me/Blog/7fd519e5/</url>
      <content type="html"><![CDATA[<p>Many articles are talking about the differences between GCP and AWS.
Is that true one is superior to another?
Or they are just apples and oranges?
For me, I never treat them seriously, as my daily job is heavily on GCP.
However, recently I got a project which needs to integrate these two cloud providers’ services.
Now the headache is coming.</p>
<p><img src="https://miro.medium.com/max/1033/1*AaYOwm0dahyNhZ0K-5il8Q.png" alt="Cloud Function vs Lambda"></p>
<p>This comparison is based on a developer perspective, who is fresh to AWS and expert (self-claimed) in GCP.</p>
<h2 id="Development-Speed"><a href="#Development-Speed" class="headerlink" title="Development Speed"></a>Development Speed</h2><p>Both can start coding without documents when using the first time.
I feel this is a great advantage to move product to cloud, saving tons of development time.</p>
<p>However, I feel Cloud Function is simpler, agile, and more intuitive compared to Lambda based on the following:</p>
<ol>
<li>Lambda needs to set API gateway in order to trigger it by URL</li>
<li>Lambda does not support install Python packages, to do so, you have to upload your code with packages in a zip or build a customized runtime environment.</li>
<li>Lambda HTTP trigger passes in the request within a wrapper, not raw request with body and header info. So need to understand its parameter structures.</li>
<li>Lambda has to enable the <a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-payload-encodings-configure-with-console.html" target="_blank" rel="noopener">binary support</a> for certain content types.</li>
<li>Lambda built-in editor does not support uploaded zip with too many files.</li>
</ol>
<p>So the winner is obvious, Cloud Function is the better choice if you don’t want to deal with package installation or HTTP trigger settings.</p>
<h2 id="Deploy-Speed"><a href="#Deploy-Speed" class="headerlink" title="Deploy Speed"></a>Deploy Speed</h2><p>This one I have to say that AWS has impressed me.
Every time if I clicked the save, the code has already deployed, although this comes with a drawback that less customizability.
I enjoy this fast and non-interrupted deployment process.
Almost every service could be instantly provisioned, modified, and deleted.
(So far our codebase is relatively small like ~500 lines of code for each service)</p>
<p>So what does the GCP lack?</p>
<ol>
<li>Most services under GCP need several minutes to provision.</li>
<li>Cloud Functions take a couple of minutes to deploy a new version, even just change a line of comment.</li>
<li>Searching for other services feels slower than AWS.</li>
</ol>
<p>All in all, GCP feels slower in many aspects, so AWS has a smoother user experience.</p>
<h2 id="Debugging"><a href="#Debugging" class="headerlink" title="Debugging"></a>Debugging</h2><p>Lambda auto wins this track, due to an on-going <a href="https://issuetracker.google.com/issues/155215191" target="_blank" rel="noopener">log issue</a> in Cloud Functions, which causes no logging when function crashes.
Besides the issue, both provide detailed trace logs.
Moreover, Lambda provides a configurable test event to run the function on the fly, which really neat.</p>
<h2 id="Docs"><a href="#Docs" class="headerlink" title="Docs"></a>Docs</h2><p>This won’t affect the user experience for experts, but definitely a plus for newcomers.
Maybe just because I’m newbie to AWS, I always find it difficult to read the official documents.</p>
<ol>
<li>There is no programming language switcher in the code section, you always need to find a dedicated page for a specific programming language.</li>
<li>Most operations have to use CLI, which creates a barrier for people like me who just would like to try and do not want to mess up our dev machine.</li>
<li>No Cloud Shell. A similar reason to the previous one. Although this is not a doc, it is nice to try the tutorials in a setup environment, so less weird errors due to package versioning.</li>
</ol>
<p>Actually, cloud techniques are pretty alike among providers.
Although the under table infrastructures may differ, the user-level implementations do not vary too much.
With better doc would attract more people who are new to the cloud.
From this perspective, GCP did a very good job of providing tutorials and tools.</p>
<h2 id="Pricing"><a href="#Pricing" class="headerlink" title="Pricing"></a>Pricing</h2><p>This influences the least to developers.
It is no good or bad, it is all depending on the traffic volume and the boss’s preferences.</p>
<table>
<thead>
<tr>
<th style="text-align:center">Provider</th>
<th style="text-align:center">Lambda</th>
<th style="text-align:center">Cloud Functions</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Pricing</td>
<td style="text-align:center">1M/month requests and 400K GB-sec/month compute time for <strong>free</strong>, then $0.20/1M requests and $0.00001667/GB-sec</td>
<td style="text-align:center">2M/month requests and (400K GB-sec/month, 200K GHz-sec/month) compute time for <strong>free</strong>, then $0.40/1M invocations, plus $0.0000025/GB-sec and $0.00001/GHz-sec</td>
</tr>
</tbody>
</table>
<p>Cloud Functions have a more complex formula to calculate the compute time pricing.
Basically, it adds the CPU usage (GHz-sec) into the calculation.
So Lambda is cheaper if not using the provisioned concurrency, which charges <a href="https://aws.amazon.com/lambda/pricing/#Provisioned_Concurrency_Pricing" target="_blank" rel="noopener">extra cost</a>.</p>
<p>Here comes the question, does Cloud Function have a similar provisioned concurrency feature?</p>
<h2 id="Integration"><a href="#Integration" class="headerlink" title="Integration"></a>Integration</h2><p>This is a general talk about how to integrate services on different cloud platforms, not specified to cloud functions or lambda.</p>
<p>Both products are integrated well with other cloud products within the same cloud provider.
Unless there is a unique cloud service, most development could be done within a single cloud provider.
If you feel the developers do not have enough work, distribute your services into two or three cloud providers.
They will spend most of their time on how to integrate those services, instead of actual development.</p>
<h2 id="Finally"><a href="#Finally" class="headerlink" title="Finally"></a>Finally</h2><p>This comparison is based on my personal experience.
Both have advantages and disadvantages, please choose based on your use cases.
But keep in mind, don’t try to integrate them!
This is the only advice I learned from using both.</p>
]]></content>
      
        <categories>
            
            <category> Cloud </category>
            
        </categories>
        
        
        <tags>
            
            <tag> GCP </tag>
            
            <tag> Google Cloud </tag>
            
            <tag> Cloud Function </tag>
            
            <tag> AWS </tag>
            
            <tag> Lambda </tag>
            
            <tag> API Gateway </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[How to print access token inside Cloud Function]]></title>
      <url>https://en.abnerchou.me/Blog/5c4867ce/</url>
      <content type="html"><![CDATA[<p><strong>As Cloud Function supports many programming languages, this article will use Python for the demonstration</strong></p>
<p><img src="https://miro.medium.com/proxy/1*MeXs5Ot8X49Fn1vE_13ukA.png" alt="Cloud Function Logo"></p>
<p>If anyone has used the Google Cloud Function, they probably stuck at the limited system packages [1]. 
There is no <code>curl</code> or <code>wget</code>, and could not customize the runtime system.
Like the document stated, it is a fully managed environment.
Someone may jump out and yell out the name Cloud Run.
Yes, Cloud Run will be the successor of Cloud Function in many aspects.
However, it does not support the trigger from the Cloud Storage bucket.
Yes, yes, yes, you can use Pub/Sub in Cloud Run to implement the bucket trigger.
But why not keep it simple?</p>
<h2 id="Use-cases"><a href="#Use-cases" class="headerlink" title="Use cases"></a>Use cases</h2><p>During the local environment testing, we normally use <code>gcloud auth application-default print-access-token</code> [2] to get the authentication to call the Google API endpoint.
It could be integrated into a <code>curl</code> command within a script or subprocess in your code.
You may see the following command in may GCP API tutorials:</p>
<pre class=" language-bash"><code class="language-bash">curl -H <span class="token string">"Content-Type: application/x-www-form-urlencoded"</span> -d <span class="token string">"access_token=<span class="token variable"><span class="token variable">$(</span>gcloud auth application-default print-access-token<span class="token variable">)</span></span>"</span> https://www.googleapis.com/oauth2/v1/tokeninfo
</code></pre>
<p>After tested everything working fine on our local machine, it is time to move to the cloud.
We assume the Google Cloud will handle the credentials for us, because we are accessing resources withing the GCP, and using the same service account.
Our assumption will be busted by the brutal reality.
We still need to explicitly create credentials when calling other GCP services.</p>
<p>This becomes a barrier when moving to the Cloud Function.
The initial thought would be using the Python subprocess to call <code>curl</code> command.
As stated above, the <code>curl</code> does not exist and could not be installed in the Cloud Function system.
Luckily, the <code>curl</code> command can easily be replaced by the Python request package.
But, how about the <code>gcloud auth</code>? It is also not included in the system packages. 
So here is the solution.</p>
<h2 id="Solutions"><a href="#Solutions" class="headerlink" title="Solutions"></a>Solutions</h2><p>We know there is a google-auth Python package [3] to handle GCP related authentications.
The <code>google.auth.default()</code> could return a credential object which has a token field.
Looks promising, isn’t it?
How about getting the token from google-auth?
So I wrote the following code:
(The following code could be directly run in Cloud Function)</p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> google<span class="token punctuation">.</span>auth

<span class="token keyword">def</span> <span class="token function">get_token</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
  cred<span class="token punctuation">,</span> project_id <span class="token operator">=</span> google<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>default<span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> f<span class="token string">'{cred.__dict__}'</span>
</code></pre>
<p>Well, the output shows nothing:</p>
<pre><code>{&#39;token&#39;: None, &#39;expiry&#39;: None, &#39;_scopes&#39;: None, &#39;_service_account_email&#39;: &#39;default&#39;}
</code></pre><p>The google-auth package is not open source, so I could find the logic when the token field is populated.
Therefore, I came up with an assumption that the token field would be populated during usage.
I will use Document AI as an example, you could use other GCP services, I think the logic behind should be the same.
I rewrite the sample code [4] to fit the Cloud Function:</p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> google<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>documentai <span class="token keyword">as</span> gcd
<span class="token keyword">import</span> google<span class="token punctuation">.</span>auth

<span class="token keyword">def</span> <span class="token function">get_token</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
  cred<span class="token punctuation">,</span> project_id <span class="token operator">=</span> google<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>default<span class="token punctuation">(</span><span class="token punctuation">)</span>
  gcd_client <span class="token operator">=</span> gcd<span class="token punctuation">.</span>DocumentUnderstandingServiceClient<span class="token punctuation">(</span>credentials<span class="token operator">=</span>cred<span class="token punctuation">)</span>

  req <span class="token operator">=</span> gcd<span class="token punctuation">.</span>ProcessDocumentRequest<span class="token punctuation">(</span>
      parent<span class="token operator">=</span>f<span class="token string">"projects/{project_id}"</span><span class="token punctuation">,</span>
      input_config<span class="token operator">=</span><span class="token punctuation">{</span>
              <span class="token string">'gcs_source'</span><span class="token punctuation">:</span><span class="token punctuation">{</span>
                  <span class="token string">'uri'</span><span class="token punctuation">:</span> <span class="token string">'gs://cloud-samples-data/documentai/form.pdf'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
              <span class="token string">'mime_type'</span><span class="token punctuation">:</span><span class="token string">"application/pdf"</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
      document_type<span class="token operator">=</span><span class="token string">"general"</span><span class="token punctuation">,</span> 
      form_extraction_params<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'enabled'</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> f<span class="token string">'{cred.__dict__}'</span>
</code></pre>
<p>Still, the <code>token</code> is None.
Okay, seems it has not been updated at all.
I only used the document AI package initialization to avoid the extra charge on invoking the actual process.
However, if we actual process the document by adding <code>response = gcd_client.process_document(request=req)</code> before the return statement.
The magic happens.</p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> google<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>documentai <span class="token keyword">as</span> gcd
<span class="token keyword">import</span> google<span class="token punctuation">.</span>auth

<span class="token keyword">def</span> <span class="token function">get_token</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
  cred<span class="token punctuation">,</span> project_id <span class="token operator">=</span> google<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>default<span class="token punctuation">(</span><span class="token punctuation">)</span>
  gcd_client <span class="token operator">=</span> gcd<span class="token punctuation">.</span>DocumentUnderstandingServiceClient<span class="token punctuation">(</span>credentials<span class="token operator">=</span>cred<span class="token punctuation">)</span>

  req <span class="token operator">=</span> gcd<span class="token punctuation">.</span>ProcessDocumentRequest<span class="token punctuation">(</span>
      parent<span class="token operator">=</span>f<span class="token string">"projects/{project_id}"</span><span class="token punctuation">,</span>
      input_config<span class="token operator">=</span><span class="token punctuation">{</span>
              <span class="token string">'gcs_source'</span><span class="token punctuation">:</span><span class="token punctuation">{</span>
                  <span class="token string">'uri'</span><span class="token punctuation">:</span> <span class="token string">'gs://cloud-samples-data/documentai/form.pdf'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
              <span class="token string">'mime_type'</span><span class="token punctuation">:</span><span class="token string">"application/pdf"</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
      document_type<span class="token operator">=</span><span class="token string">"general"</span><span class="token punctuation">,</span> 
      form_extraction_params<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'enabled'</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

  response <span class="token operator">=</span> gcd_client<span class="token punctuation">.</span>process_document<span class="token punctuation">(</span>request<span class="token operator">=</span>req<span class="token punctuation">)</span>

  <span class="token keyword">return</span> f<span class="token string">'{cred.__dict__}'</span>
</code></pre>
<p>To avoid the security breach, I will not post the output here.
You will see the <code>token</code> field has the value we are seeking for.
Well, we have to pay for the usage of the document AI API calls.</p>
<h3 id="Need-simpler"><a href="#Need-simpler" class="headerlink" title="Need simpler"></a>Need simpler</h3><p>We could use the Cloud Logging SDK, which does not need many details for the request body.
Comparing to the previous method, the cost is even lower, almost free [5].</p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> google<span class="token punctuation">.</span>auth
<span class="token keyword">import</span> google<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>logging <span class="token keyword">as</span> cloud_logging

<span class="token keyword">def</span> <span class="token function">get_token</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    cred<span class="token punctuation">,</span> _ <span class="token operator">=</span> google<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>default<span class="token punctuation">(</span><span class="token punctuation">)</span>
    cloud_client <span class="token operator">=</span> cloud_logging<span class="token punctuation">.</span>Client<span class="token punctuation">(</span>credentials<span class="token operator">=</span>credentials<span class="token punctuation">)</span>
    log_name <span class="token operator">=</span> <span class="token string">'cloudfunctions.googleapis.com%2Fcloud-functions'</span>
    cloud_logger <span class="token operator">=</span> cloud_client<span class="token punctuation">.</span>logger<span class="token punctuation">(</span>log_name<span class="token punctuation">)</span>
    all_entries <span class="token operator">=</span> cloud_logger<span class="token punctuation">.</span>list_entries<span class="token punctuation">(</span>page_size<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
    entries <span class="token operator">=</span> next<span class="token punctuation">(</span>all_entries<span class="token punctuation">.</span>pages<span class="token punctuation">)</span>

    <span class="token keyword">return</span> f<span class="token string">"{cred.__dict__}"</span>
</code></pre>
<h3 id="More-simpler"><a href="#More-simpler" class="headerlink" title="More simpler"></a>More simpler</h3><p>If we could use different Cloud Python SDKs, is there an SDK can have a minimal number of line of code?
Yes, here is what I found – Cloud Translate, which charges based on the translated characters [6].
So we only need to process one char to obtain the token.
The free tier quota (500,000 chars) is big enough for testing purposes.</p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> google<span class="token punctuation">.</span>cloud <span class="token keyword">import</span> translate_v3
<span class="token keyword">import</span> google<span class="token punctuation">.</span>auth

<span class="token keyword">def</span> <span class="token function">get_token</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    credentials<span class="token punctuation">,</span> project_id <span class="token operator">=</span> google<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>default<span class="token punctuation">(</span><span class="token punctuation">)</span>
    client <span class="token operator">=</span> translate_v3<span class="token punctuation">.</span>TranslationServiceClient<span class="token punctuation">(</span>credentials<span class="token operator">=</span>credentials<span class="token punctuation">)</span>
    parent <span class="token operator">=</span> client<span class="token punctuation">.</span>location_path<span class="token punctuation">(</span><span class="token string">'project-id'</span><span class="token punctuation">,</span> <span class="token string">'us-central1'</span><span class="token punctuation">)</span>

    response <span class="token operator">=</span> client<span class="token punctuation">.</span>translate_text<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> target_language_code<span class="token operator">=</span><span class="token string">'en'</span><span class="token punctuation">,</span> parent<span class="token operator">=</span>parent<span class="token punctuation">)</span>

    <span class="token keyword">return</span> f<span class="token string">"{credentials.__dict__}"</span>
</code></pre>
<p>The pattern is:</p>
<ol>
<li>Get credential object from google.auth.default()</li>
<li>Initialize a Cloud Service SDK and pass in the credential object as a parameter</li>
<li>Call the service API with minimal cost data, the token will be populated into the credential object</li>
</ol>
<p>You can come up with your solution by using different Python SDKs [7].</p>
<h3 id="Mission-complete"><a href="#Mission-complete" class="headerlink" title="Mission complete!?"></a>Mission complete!?</h3><h2 id="Ultimate-solution"><a href="#Ultimate-solution" class="headerlink" title="Ultimate solution"></a>Ultimate solution</h2><p>If there are Python SDKs for GCP services, why bother to get the access token, call them directly in your code.</p>
<iframe src="https://giphy.com/embed/uHox9Jm5TyTPa" width="480" height="253" frameborder="0" class="giphy-embed" allowfullscreen></iframe>

<p>Anyway, this is a great example of rebuilding the wheel process, hope can provide some insights!</p>
<p>[1] <a href="https://cloud.google.com/functions/docs/reference/python-system-packages" target="_blank" rel="noopener">https://cloud.google.com/functions/docs/reference/python-system-packages</a></p>
<p>[2] <a href="https://cloud.google.com/sdk/gcloud/reference/auth/application-default/print-access-token" target="_blank" rel="noopener">https://cloud.google.com/sdk/gcloud/reference/auth/application-default/print-access-token</a></p>
<p>[3] <a href="https://google-auth.readthedocs.io/en/latest/" target="_blank" rel="noopener">https://google-auth.readthedocs.io/en/latest/</a></p>
<p>[4] <a href="https://github.com/GoogleCloudPlatform/python-docs-samples/blob/master/document/cloud-client/parse_form_beta.py" target="_blank" rel="noopener">https://github.com/GoogleCloudPlatform/python-docs-samples/blob/master/document/cloud-client/parse_form_beta.py</a></p>
<p>[5] <a href="https://cloud.google.com/stackdriver/pricing" target="_blank" rel="noopener">https://cloud.google.com/stackdriver/pricing</a></p>
<p>[6] <a href="https://cloud.google.com/translate/pricing" target="_blank" rel="noopener">https://cloud.google.com/translate/pricing</a></p>
<p>[7] <a href="https://github.com/googleapis/google-cloud-python" target="_blank" rel="noopener">https://github.com/googleapis/google-cloud-python</a></p>
]]></content>
      
        <categories>
            
            <category> Cloud </category>
            
        </categories>
        
        
        <tags>
            
            <tag> GCP </tag>
            
            <tag> Google Cloud </tag>
            
            <tag> Cloud Function </tag>
            
            <tag> Token </tag>
            
            <tag> Credential </tag>
            
            <tag> Auth </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Why you need QT for your side projects]]></title>
      <url>https://en.abnerchou.me/Blog/7d17e074/</url>
      <content type="html"><![CDATA[<p>I’m working on an side project which need a fancy GUI interface, so I was choosing between Webassemble and QT.
This article will briefly descibe how I made the decision.</p>
<a id="more"></a>
<p>TL;DR: I choose QT as sibe project GUI creator for its strong community and webassemble support.</p>
<p>Before I start mubling, I would like to state my view on the GUI vs CLI.
I like to use CLI, as it is easy to integrate with pipe and automation process.
Also devloping CLI is focusing on functionality instead of aligning pixels.
Moreover, it feels geek and cool.
However, I also found the esiest understandable application usually have a good GUI.
A picture is worthing a thousand of words.
GUI is that picture in a program.
The best applications in my mind is that have both GUI and CLI.</p>
<p>Recently, I was looking for a GUI library which is open source and cross-platform.
The first thing comes to my mind is the web development, like React and Vue.
However, JS has bad reputation on performance, and my side project is based on video processing.
Then I googled a little bit, seems webassemble is the best solution to overcome the performance concerns.
But QT can also generate webassemble applications.</p>
<p>After trying both, I have conclude their pros and cons in the following:</p>
<h3 id="Webassemble"><a href="#Webassemble" class="headerlink" title="Webassemble"></a>Webassemble</h3><h4 id="Pros"><a href="#Pros" class="headerlink" title="Pros"></a>Pros</h4><ul>
<li>New technology</li>
<li>Supported by major browsers</li>
<li>Faster</li>
</ul>
<h4 id="Cons"><a href="#Cons" class="headerlink" title="Cons"></a>Cons</h4><ul>
<li>Performance is generally 30% better than JS (not really impresive)(<a href="https://medium.com/@torch2424/webassembly-is-fast-a-real-world-benchmark-of-webassembly-vs-es6-d85a23f8e193" target="_blank" rel="noopener">ref</a>)</li>
<li>Not mature, many features underdevlopment and can cause wired issues</li>
<li>Only support C/C++</li>
</ul>
<h3 id="QT"><a href="#QT" class="headerlink" title="QT"></a>QT</h3><h4 id="Pros-1"><a href="#Pros-1" class="headerlink" title="Pros"></a>Pros</h4><ul>
<li>Support Python (personal preference)</li>
<li>Cross-platform build binary</li>
<li>IDE support</li>
</ul>
<h4 id="Cons-1"><a href="#Cons-1" class="headerlink" title="Cons"></a>Cons</h4><ul>
<li>Need to pay attention to its license</li>
<li>Current project directory could not be recognized correctly on Windows</li>
<li>Many issues on QT creator</li>
</ul>
<p>In summary, webassemble is still not mature for building a project.
If you still don’t want to miss this trends, use QT instead.
As it can also generate webassemble application, meanwhile, doesn’t need to worry about the low level implementation.</p>
]]></content>
      
        <categories>
            
            <category> Programming </category>
            
        </categories>
        
        
        <tags>
            
            <tag> QT </tag>
            
            <tag> GUI </tag>
            
            <tag> Webassemble </tag>
            
            <tag> Side Project </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[OpenAI Gym Board Games Env for 0.9.6 Above]]></title>
      <url>https://en.abnerchou.me/Blog/c2dbdabe/</url>
      <content type="html"><![CDATA[<p>Since Gym 0.9.6, the board games environment has been removed from the default package as they are not maintained by OpenAI [<a href="https://github.com/openai/gym/releases/tag/v0.9.6" target="_blank" rel="noopener">ref</a>].
This article helps who would like to run their AI on Go or Hex in OpenAI Gym.</p>
<a id="more"></a>
<ol>
<li><p>Locate the python Gym package folder. In my case, it is under <code>~/anaconda3/envs/openai-gym/lib/python3.5/site-packages/gym</code>.</p>
</li>
<li><p>Download the Gym <a href="https://github.com/openai/gym/archive/v0.9.5.zip" target="_blank" rel="noopener">0.9.5</a> source code which contains the board games environment.</p>
</li>
<li><p>Copy the board_game folder from 0.9.5 source code (under <code>/gym-0.9.5/gym/envs/</code>) to your local Gym package envrionment folder (my case is <code>~/anaconda3/envs/openai-gym/lib/python3.5/site-packages/gym/envs</code>).</p>
</li>
<li><p>Add the following code into <strong>init</strong>.py (<code>~/anaconda3/envs/openai-gym/lib/python3.5/site-packages/gym/envs/__init__.py</code>). It will register those envs.</p>
</li>
</ol>
<pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Board games</span>
<span class="token comment" spellcheck="true"># ----------------------------------------</span>

register<span class="token punctuation">(</span>
    id<span class="token operator">=</span><span class="token string">'Go9x9-v0'</span><span class="token punctuation">,</span>
    entry_point<span class="token operator">=</span><span class="token string">'gym.envs.board_game:GoEnv'</span><span class="token punctuation">,</span>
    kwargs<span class="token operator">=</span><span class="token punctuation">{</span>
        <span class="token string">'player_color'</span><span class="token punctuation">:</span> <span class="token string">'black'</span><span class="token punctuation">,</span>
        <span class="token string">'opponent'</span><span class="token punctuation">:</span> <span class="token string">'pachi:uct:_2400'</span><span class="token punctuation">,</span>
        <span class="token string">'observation_type'</span><span class="token punctuation">:</span> <span class="token string">'image3c'</span><span class="token punctuation">,</span>
        <span class="token string">'illegal_move_mode'</span><span class="token punctuation">:</span> <span class="token string">'lose'</span><span class="token punctuation">,</span>
        <span class="token string">'board_size'</span><span class="token punctuation">:</span> <span class="token number">9</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment" spellcheck="true"># The pachi player seems not to be determistic given a fixed seed.</span>
    <span class="token comment" spellcheck="true"># (Reproduce by running 'import gym; h = gym.make('Go9x9-v0'); h.seed(1); h.reset(); h.step(15); h.step(16); h.step(17)' a few times.)</span>
    <span class="token comment" spellcheck="true">#</span>
    <span class="token comment" spellcheck="true"># This is probably due to a computation time limit.</span>
    nondeterministic<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>

register<span class="token punctuation">(</span>
    id<span class="token operator">=</span><span class="token string">'Go19x19-v0'</span><span class="token punctuation">,</span>
    entry_point<span class="token operator">=</span><span class="token string">'gym.envs.board_game:GoEnv'</span><span class="token punctuation">,</span>
    kwargs<span class="token operator">=</span><span class="token punctuation">{</span>
        <span class="token string">'player_color'</span><span class="token punctuation">:</span> <span class="token string">'black'</span><span class="token punctuation">,</span>
        <span class="token string">'opponent'</span><span class="token punctuation">:</span> <span class="token string">'pachi:uct:_2400'</span><span class="token punctuation">,</span>
        <span class="token string">'observation_type'</span><span class="token punctuation">:</span> <span class="token string">'image3c'</span><span class="token punctuation">,</span>
        <span class="token string">'illegal_move_mode'</span><span class="token punctuation">:</span> <span class="token string">'lose'</span><span class="token punctuation">,</span>
        <span class="token string">'board_size'</span><span class="token punctuation">:</span> <span class="token number">19</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    nondeterministic<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>

register<span class="token punctuation">(</span>
    id<span class="token operator">=</span><span class="token string">'Hex9x9-v0'</span><span class="token punctuation">,</span>
    entry_point<span class="token operator">=</span><span class="token string">'gym.envs.board_game:HexEnv'</span><span class="token punctuation">,</span>
    kwargs<span class="token operator">=</span><span class="token punctuation">{</span>
        <span class="token string">'player_color'</span><span class="token punctuation">:</span> <span class="token string">'black'</span><span class="token punctuation">,</span>
        <span class="token string">'opponent'</span><span class="token punctuation">:</span> <span class="token string">'random'</span><span class="token punctuation">,</span>
        <span class="token string">'observation_type'</span><span class="token punctuation">:</span> <span class="token string">'numpy3c'</span><span class="token punctuation">,</span>
        <span class="token string">'illegal_move_mode'</span><span class="token punctuation">:</span> <span class="token string">'lose'</span><span class="token punctuation">,</span>
        <span class="token string">'board_size'</span><span class="token punctuation">:</span> <span class="token number">9</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
</code></pre>
<ol start="5">
<li>Install <a href="https://github.com/openai/pachi-py" target="_blank" rel="noopener">pachi-py</a> via <code>pip install pachi-py</code> for go env.</li>
</ol>
<p>Then it’s all set to use the board game environment.</p>
<p>All in all, Gym is built for testing reinforcement learning, and the reinforcement learning gains fames from the DeepMind AlphaGo. 
Personally, removing Go env from Gym is not a smart move for marketing.</p>
]]></content>
      
        <categories>
            
            <category> AI </category>
            
        </categories>
        
        
        <tags>
            
            <tag> OpenAI </tag>
            
            <tag> Gym </tag>
            
            <tag> Board Games </tag>
            
            <tag> Go </tag>
            
            <tag> Hex </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Leetcode VS EPI]]></title>
      <url>https://en.abnerchou.me/Blog/1d6c1157/</url>
      <content type="html"><![CDATA[<p><strong> This article is still work in progress. </strong></p>
<p>Here is a list of problems which both on Leetcode and EPI<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>. In my opinion, these common appeared questions are more important. Hope this could help job seekers to prepare for their final interviews.</p>
<a id="more"></a>
<table>
<thead>
<tr>
<th style="text-align:center">Leetcode<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup></th>
<th style="text-align:center">EPI<sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup></th>
<th style="text-align:center">Difficulty<sup id="fnref:4"><a href="#fn:4" rel="footnote">4</a></sup></th>
<th style="text-align:center">Problem<sup id="fnref:5"><a href="#fn:5" rel="footnote">5</a></sup></th>
<th style="text-align:center">Company<sup id="fnref:6"><a href="#fn:6" rel="footnote">6</a></sup></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">21</td>
<td style="text-align:center">7.1</td>
<td style="text-align:center">Easy</td>
<td style="text-align:center">Merge Two Sorted Lists</td>
<td style="text-align:center">Amazon</td>
</tr>
<tr>
<td style="text-align:center">20</td>
<td style="text-align:center">8.3</td>
<td style="text-align:center">Easy</td>
<td style="text-align:center">Valid Parentheses</td>
<td style="text-align:center">Amazon</td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:center">6.1</td>
<td style="text-align:center">Medium</td>
<td style="text-align:center">String to Integer (atoi)</td>
<td style="text-align:center">Amazon</td>
</tr>
<tr>
<td style="text-align:center">48</td>
<td style="text-align:center">5.19</td>
<td style="text-align:center">Medium</td>
<td style="text-align:center">Rotate Image</td>
<td style="text-align:center">Amazon</td>
</tr>
<tr>
<td style="text-align:center">15</td>
<td style="text-align:center">17.4</td>
<td style="text-align:center">Medium</td>
<td style="text-align:center">3-Sum</td>
<td style="text-align:center">Amazon</td>
</tr>
<tr>
<td style="text-align:center">42</td>
<td style="text-align:center">24.32</td>
<td style="text-align:center">Hard</td>
<td style="text-align:center">Trapping Rain Water</td>
<td style="text-align:center">Amazon</td>
</tr>
<tr>
<td style="text-align:center">121</td>
<td style="text-align:center">5.6</td>
<td style="text-align:center">Easy</td>
<td style="text-align:center">Best Time to Buy and Sell Stock</td>
<td style="text-align:center">Amazon</td>
</tr>
<tr>
<td style="text-align:center">89</td>
<td style="text-align:center">15.10</td>
<td style="text-align:center">Medium</td>
<td style="text-align:center">Gray Code</td>
<td style="text-align:center">Amazon</td>
</tr>
<tr>
<td style="text-align:center">235</td>
<td style="text-align:center">9.3</td>
<td style="text-align:center">Easy</td>
<td style="text-align:center">Lowest Common Ancestor of a Binary Search Tree</td>
<td style="text-align:center">Amazon</td>
</tr>
<tr>
<td style="text-align:center">98</td>
<td style="text-align:center">14.1</td>
<td style="text-align:center">Medium</td>
<td style="text-align:center">Validate Binary Search Tree</td>
<td style="text-align:center">Amazon</td>
</tr>
<tr>
<td style="text-align:center">141</td>
<td style="text-align:center">7.3</td>
<td style="text-align:center">Easy</td>
<td style="text-align:center">Linked List Cycle</td>
<td style="text-align:center">Amazon</td>
</tr>
<tr>
<td style="text-align:center">240</td>
<td style="text-align:center">11.6</td>
<td style="text-align:center">Medium</td>
<td style="text-align:center">Search a 2D Matrix II</td>
<td style="text-align:center">Amazon</td>
</tr>
<tr>
<td style="text-align:center">234</td>
<td style="text-align:center">7.11</td>
<td style="text-align:center">Easy</td>
<td style="text-align:center">Palindrome Linked List</td>
<td style="text-align:center">Amazon</td>
</tr>
<tr>
<td style="text-align:center">215</td>
<td style="text-align:center">24.17</td>
<td style="text-align:center">Medium</td>
<td style="text-align:center">Kth Largest Element in an Array</td>
<td style="text-align:center">Amazon</td>
</tr>
<tr>
<td style="text-align:center">579</td>
<td style="text-align:center">13.12</td>
<td style="text-align:center">Hard</td>
<td style="text-align:center">Find Cumulative Salary of an Employee</td>
<td style="text-align:center">Amazon</td>
</tr>
</tbody>
</table>
<div id="footnotes"><hr><div id="footnotelist"><ol style="list-style:none; padding-left: 0;"><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">1.</span><span style="display: inline-block; vertical-align: top;">The book &quot;Elements of Programming Interviews&quot;. <a href="https://elementsofprogramminginterviews.com/" target="_blank" rel="noopener">https://elementsofprogramminginterviews.com/</a></span><a href="#fnref:1" rev="footnote"> ↩</a></li><li id="fn:2"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">2.</span><span style="display: inline-block; vertical-align: top;">Problem index on Leetcode. <a href="https://leetcode.com/" target="_blank" rel="noopener">https://leetcode.com/</a></span><a href="#fnref:2" rev="footnote"> ↩</a></li><li id="fn:3"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">3.</span><span style="display: inline-block; vertical-align: top;">Problem index on EPI.</span><a href="#fnref:3" rev="footnote"> ↩</a></li><li id="fn:4"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">4.</span><span style="display: inline-block; vertical-align: top;">The difficulty of the problem on Leetcode.</span><a href="#fnref:4" rev="footnote"> ↩</a></li><li id="fn:5"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">5.</span><span style="display: inline-block; vertical-align: top;">The problem title on Leetcode.</span><a href="#fnref:5" rev="footnote"> ↩</a></li><li id="fn:6"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">6.</span><span style="display: inline-block; vertical-align: top;">The company tags on Leetcode indicate the problem has appeared in their interview.</span><a href="#fnref:6" rev="footnote"> ↩</a></li></ol></div></div>]]></content>
      
        <categories>
            
            <category> Exam </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Leetcode </tag>
            
            <tag> EPI </tag>
            
            <tag> Interview </tag>
            
            <tag> Job </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[A Real Scenario Machine Learning Question]]></title>
      <url>https://en.abnerchou.me/Blog/54a83d07/</url>
      <content type="html"><![CDATA[<p>Recently I got a real scenario machine learning question, which does not have existing models. I would like to record my thoughts here which may save my time later.</p>
<p>Here is the question:</p>
<blockquote>
<p>A company receives thousands of documents everyday uploaded by our users. Generally these documents are invoices or bills. We would like to extract the vendor​ and amount​ from these documents automatically (i.e. using software rather than human inspection).</p>
</blockquote>
<blockquote>
<p>They store the following pieces of information for each document:</p>
<ol>
<li>The pdf document uploaded by the user (please see example.pdf attached)</li>
<li>The text extracted from that pdf (please see example.txt attached - Note: often the extracted text would not be in an order that seems natural to a human reader)</li>
<li>Labels of what the vendor and amount should be for each document (in the attached
example, vendor would be “Marketing Fuel Biz.”, and amount would be “747.50”).</li>
</ol>
</blockquote>
<blockquote>
<p>Question: Describe a machine learning solution to this problem.</p>
</blockquote>
<blockquote>
<p>Additon: Some percentage of the stored labels may be incorrect. What would you change to mitigate this problem.</p>
</blockquote>
<p>The sample pdf and OCR output txt is <a href="/asserts/ml-example.zip">downloadable</a>. </p>
<a id="more"></a>
<h2 id="Intuitive-Thoughts"><a href="#Intuitive-Thoughts" class="headerlink" title="Intuitive Thoughts"></a>Intuitive Thoughts</h2><p>As the OCR result loses the invoice position information (sample txt file), the traditional NLP methods, which expect sequential structure, would not work on such text corpus [<a href="https://www.diva-portal.org/smash/get/diva2:934351/FULLTEXT01.pdf" target="_blank" rel="noopener">1</a>]. So my proposed solution would focus on rebuilding the invoice structure information.</p>
<p>Based on my understanding, the invoice structure follows a certain pattern, such as the left top area is vendor logo/name and the total amount is in the bottom right. There are definitely some special cases, but the prior statement is an assumption of my solution.</p>
<p>In order to track the position in a PDF file (could be easily convert to an image file), the convolutional neural networks (CNN) [<a href="https://en.wikipedia.org/wiki/Convolutional_neural_network" target="_blank" rel="noopener">2</a>] could fit this task, it has been proved successfully on many image processing tasks [<a href="https://arxiv.org/abs/1504.08083" target="_blank" rel="noopener">3</a>, <a href="https://arxiv.org/abs/1506.01497" target="_blank" rel="noopener">4</a>, <a href="https://arxiv.org/abs/1703.06870" target="_blank" rel="noopener">5</a>]. Although a paper [<a href="https://arxiv.org/pdf/1708.07403.pdf" target="_blank" rel="noopener">6</a>] states to extract invoice info from the recurrent neural network (RNN), their input is words and positions (in our case, we do not have positions).  So I propose to use Faster R-CNN [<a href="https://arxiv.org/abs/1506.01497" target="_blank" rel="noopener">4</a>] or YOLO [<a href="https://pjreddie.com/darknet/yolo/" target="_blank" rel="noopener">7</a>] to solve the problem, they both are mature models of object detection and applied in many products.</p>
<p>The CNN model input should be images, and outputs are labels and region coordinate (the format would be like {vendor, 5, 15, 20, 40}).</p>
<p>Therefore, we need a dataset to train the CNN model. Since we already have the original PDF files and labels of vendor/amount, we could generate an image dataset for training the model. For each training entry, it contains an image converted from PDF and a region info of vendor/amount. The region info is the coordinate of two points which consist of a rectangle (e.g. (x1, y1) and (x2, y2) in figure 1). The dataset generation process could be done via a method of ORC and image process combination. The method is cropping the image into multiple rectangles (moving windows), then apply ORC on each rectangle. Based on the text outputs of rectangles, the area contains only vendor name is labeled as vendor, and the areas contain the amount are labeled as amount.</p>
<p><img src="/img/ml-questions-1.png" alt=""></p>
<p>After we have the dataset, we split it into training and testing datasets. The split ratio could be 80/20 [<a href="https://developers.google.com/machine-learning/crash-course/training-and-test-sets/splitting-data" target="_blank" rel="noopener">8</a>].</p>
<p>The evaluation metric is mean precision average (mPA) at the different intersection over union (IoU) thresholds. The IoU of a proposed set of object pixels and a set of true object pixels is calculated as IoU(A,B)=A∩B/A∪B (image below [<a href="https://www.pyimagesearch.com/2016/11/07/intersection-over-union-iou-for-object-detection/" target="_blank" rel="noopener">9</a>]). The metric sweeps over a range of IoU thresholds, at each point calculating an average precision value. The threshold values range from 0.5 to 0.95 with a step size of 0.05: (0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95). In other words, at a threshold of 0.5, a predicted object is considered a “hit” if its intersection over union with a ground truth object is greater than 0.5. At each threshold t, we can check if it “hit” on the ground truth. Then the mPA is 1/thresholds∑hit(t).</p>
<p><img src="/img/ml-questions-2.png" alt=""></p>
<p>When the model training finished (let’s assume it meets our expectation), we could apply a post process to convert the result to our label. We will get the region coordinate from the model output, and based on the coordinate, we can crop the rectangle and feed it to OCR. It is the final result. Then we can compare the predicated labels with our ground truth in the database to evaluate the model performance (the evaluation metric could be precision on both labels).</p>
<p>Here is the overview of the proposed solution:</p>
<pre><code>Convert PDF to Image -&gt; Dataset Preparation -&gt; CNN Model -&gt; OCR -&gt; Results
</code></pre><p>To mitigate the impact of incorrect labels, we could add an extra step in dataset preparation. By calculating the frequency of each vendor label in the dataset, we could remove those entries with label frequency lower than a threshold. This is based on an assumption that incorrect labels cannot occur multiple times (the threshold) with the same value.</p>
<h3 id="Failure-on-the-Intuitive-Thoughts"><a href="#Failure-on-the-Intuitive-Thoughts" class="headerlink" title="Failure on the Intuitive Thoughts"></a>Failure on the Intuitive Thoughts</h3><p>I set up an experiment for the solution, which trained YOLOv3 [<a href="https://pjreddie.com/darknet/yolo/" target="_blank" rel="noopener">10</a>] (pre-trained on ImageNet [<a href="http://www.image-net.org/" target="_blank" rel="noopener">11</a>]) with 30 manually labeled invoices images (google searched images, each invoice contains vendor, logo, and amount labels). Although the predicated labels on validation dataset look promising, the mAP is almost zero on the test dataset. The reason for the low performance may be caused by the principle of CNN, the CNN only can learn the features that appear in the training set. The way to improve the model would be training on a larger dataset and assume it covers all test cases. Therefore, I would like to propose two new solutions for the ML question.</p>
<ol>
<li>Using the Recurrent Neural Network (RNN) with Long Short-Term Memory cells (LSTM) [<a href="https://en.wikipedia.org/wiki/Long_short-term_memory" target="_blank" rel="noopener">12</a>].</li>
<li>Using the Reinforcement Learning (RL) [<a href="https://en.wikipedia.org/wiki/Reinforcement_learning" target="_blank" rel="noopener">13</a>].</li>
</ol>
<h2 id="RNN"><a href="#RNN" class="headerlink" title="RNN"></a>RNN</h2><p>I reviewed the example.txt file, it doesn’t fully unorganized. We could recognize some patterns from it, like it reads column by column, not row by row as human do. Although RNN is good at the sequential data, due to the gradient vanishing problem, it won’t work for long sentence. So the LSTM method came up, bring the ability to memory long distance relationship to RNN. For example, “A cat jumps on the table, it breaks a cup, so we chase it off the table” which “it” represents the “cat” in the previous phrase. It may be easy to identify the first “it” as the cat because they are close, but for the second “it”, it’s hard to tell which it represents (cat, table, or cup).</p>
<p>As we are processing the text data, we need a preprocessing step to clean up. First, remove punctuation marks, like semi-colon, colon, exclamation mark, and etc. But keep the period and comma, because they may use in numbers. Second, tokenize the words, we could build up a vocabulary dictionary and convert each word into it represented the index in the dictionary. For unknown word and numbers, we use [UNK] and [NUM] instead. Finally, clear up the common words which do not help for our task, like the word “invoice”, it appears in every invoice.</p>
<p>Then we could feed the data to the RNN model. The RNN model supports many to many. Input is word sequence, and the output is the all possible labels for vendor/amount.</p>
<p>The evaluation metric would be the F1 measurement [<a href="https://en.wikipedia.org/wiki/F1_score" target="_blank" rel="noopener">14</a>], which combines the precision and recall.</p>
<h2 id="RL"><a href="#RL" class="headerlink" title="RL"></a>RL</h2><p>When AlphaGo [<a href="https://deepmind.com/research/alphago/" target="_blank" rel="noopener">15</a>] defeats the world champion Lee Sedol, reinforcement learning becomes a hot topic in AI domain. The reinforcement learning is an algorithm to make AI compete with AI, the best set of policies is searched out during the competition. It has successfully applied to robotics, game playing, fintech, and ect. [<a href="https://www.oreilly.com/ideas/practical-applications-of-reinforcement-learning-in-industry" target="_blank" rel="noopener">16</a>]</p>
<p>The reason I pick up the RL is the intuitive thought in my previous email. For a human, it is easy to identify vendor and amount by a glance, so the images contain all the info we need. Therefore, I think it is not necessary to take an extra step to convert the images to text, which lose information and create an extra layer to process. </p>
<p>So the idea is to find out the areas in invoice images which represent vendor and amount, then apply OCR against those areas to get final text formatted outputs.</p>
<p>Preprocess input documents to convert them into greyscale images.</p>
<p>Before we feed images into RL model, we need to set up rules for the agents, like identify the correct item plus points, identify the logo get some point, output wrong result get minus points. Then the RL model could brute force to find the best policies, like font size, bold style, and etc.</p>
<p>The RL model output should be the rectangle area of the vendor/amount. Then apply OCR to convert them to text.</p>
<p>The evaluation metric should be same as above, using the F1 score.</p>
<h2 id="More"><a href="#More" class="headerlink" title="More"></a>More</h2><p>In addition to the above methods, I also thought about the generative adversarial networks (GANs) [<a href="https://en.wikipedia.org/wiki/Generative_adversarial_network" target="_blank" rel="noopener">17</a>], but the tuning process is more like mystery comparing other models. Moreover, I found a paper [<a href="https://arxiv.org/abs/1801.09321" target="_blank" rel="noopener">18</a>] that using the deep CNN model to classify document images based their structure. In our case, I think we could use the similar approach to identify vendors, but we still need more info to retrieve the amounts.</p>
<p>BTW, besides the machine learning models, I wonder we also could improve the OCR to include the structure information in the output, like the PDF to HTML [<a href="https://arxiv.org/abs/1801.09321" target="_blank" rel="noopener">18</a>] and Zonal OCR [<a href="https://docparser.com/blog/zonal-ocr/" target="_blank" rel="noopener">19</a>]. If the company mainly deal with PDF files. As the PDF format specification [<a href="https://www.adobe.com/content/dam/acom/en/devnet/pdf/pdfs/PDF32000_2008.pdf" target="_blank" rel="noopener">20</a>] is open to the public, we could analysis PDF files directly, this would be another story.</p>
]]></content>
      
        <categories>
            
            <category> AI </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Machine Learning </tag>
            
            <tag> OCR </tag>
            
            <tag> RNN </tag>
            
            <tag> CNN </tag>
            
            <tag> NLP </tag>
            
            <tag> natural language processing </tag>
            
            <tag> convolutional neural network </tag>
            
            <tag> recurrent neural network </tag>
            
            <tag> optical character recognition </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[DIY SLI Liquid Cooling GPU Computer]]></title>
      <url>https://en.abnerchou.me/Blog/31404856/</url>
      <content type="html"><![CDATA[<p>It’s kind of shame to say, as a computer science major professional, I have never build my own desktop computer ever, until recent. All because the old desktop dead (purchased 2012), I finally made the decision to DIY a powerful amateur deep learning machine.</p>
<p>Here I will record all the pitfalls, caveats, and tricks during the building processes. Hope could provide some help or hint for people would like to build their dream game (or amateur machine learning) machine.</p>
<a id="more"></a>
<p>Here is the <a href="https://ca.pcpartpicker.com/user/AbnerChou/saved/6zvgsY" target="_blank" rel="noopener">components list</a> for my build on PCPartPicker. The currency is Canadian Dollar since I’m living in the cold North (but don’t have the wall of cause). </p>
<table>
<thead>
<tr>
<th style="text-align:center">Parts</th>
<th style="text-align:left">Brand</th>
<th style="text-align:center">Purchase Price</th>
<th style="text-align:left">Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">CPU</td>
<td style="text-align:left">Inter Core i7-7700K 4.2Ghz Quad-Core</td>
<td style="text-align:center">$427.95</td>
<td style="text-align:left">From Memory Express.</td>
</tr>
<tr>
<td style="text-align:center">GPU</td>
<td style="text-align:left">2 X MSI GeForce 1080 DirectX 12 GTX SEA HAWK</td>
<td style="text-align:center">$732.99 X 2</td>
<td style="text-align:left">From NewEgg. Got total $40 mail-in rebates</td>
</tr>
<tr>
<td style="text-align:center">CPU Cooling</td>
<td style="text-align:left">Corsair H100i v2 Hydro Liquid CPU Cooler</td>
<td style="text-align:center">$124.99</td>
<td style="text-align:left">From Memory Express</td>
</tr>
<tr>
<td style="text-align:center">Motherboard</td>
<td style="text-align:left">ASUS PRIME Z270-A LGA 1151</td>
<td style="text-align:center">$199.99</td>
<td style="text-align:left">From NewEgg</td>
</tr>
<tr>
<td style="text-align:center">Disk</td>
<td style="text-align:left">Kingston SSD A400 480GB</td>
<td style="text-align:center">$194.10</td>
<td style="text-align:left">From Memory Express</td>
</tr>
<tr>
<td style="text-align:center">Memory</td>
<td style="text-align:left">Kingston HyperX Fury 32GB DDR4 2666MHZ 4X8GB</td>
<td style="text-align:center">$269.99</td>
<td style="text-align:left">From Memory Express</td>
</tr>
<tr>
<td style="text-align:center">Case</td>
<td style="text-align:left">Fractal Design Define S ATX Mid Tower Window Case</td>
<td style="text-align:center">$89.99</td>
<td style="text-align:left">From Canada Computers</td>
</tr>
<tr>
<td style="text-align:center">Power</td>
<td style="text-align:left">EVGA SuperNOVA 750W G2L Modular PSU</td>
<td style="text-align:center">$139.99</td>
<td style="text-align:left">From Memory Express</td>
</tr>
<tr>
<td style="text-align:center">Extra</td>
<td style="text-align:left">Asus USB-AC51 Dual-Band Wireless AC600 Wireless Adapter</td>
<td style="text-align:center">$39.99</td>
<td style="text-align:left">From Memory Express. Got $10 mail-in rebates</td>
</tr>
</tbody>
</table>
<h2 id="Purchase-items"><a href="#Purchase-items" class="headerlink" title="Purchase items"></a>Purchase items</h2><p>I have spent about a month to collect all parts. The reason why it took so long is I would lik to get the price as cheaper as possible. To ensure that, I have developed several “techniques”.</p>
<blockquote>
<p>The tricks use here are suitable for Canada or best North America, because these online services/stores are only shipping within North America or Canada only. However, you could definitely find alternatives within your regions/countries (check out <a href="https://pcpartpicker.com/" target="_blank" rel="noopener">PCPartPicker</a> support countries).</p>
</blockquote>
<p><img src="/img/diy_pc_1.jpg" alt="Before Open Box"></p>
<p>First of all, don’t forget using <a href="https://www.ebates.ca" target="_blank" rel="noopener">ebates</a>. It’s a online rebate website, user could get instant rebate if purchase through the ebates supported vendors online. The rebate rate is from 1% to 5%. Although not much, better than nothing.</p>
<p>Second, use price matching. Many online store support price matching, some even give 10% more off (I only found one). The <a href="https://www.memoryexpress.com/" target="_blank" rel="noopener">Memory Express</a> is one of my favorite computer component online shop. It provides the lowest prices most of the time, moreover, its price match is better – match the price plus 10% off on the difference. E.g, a CPU costs $500 on ME, another store has lower price for the same CPU, let’s say it $400, then the price on ME after the price match is 400-(500-400)*10% = $390. The only con shopping on ME is they charge shipping fee and don’t have local store in east Canada.</p>
<p>As mentioned above, the shipping fee may also cost a lot, especially the item weight increases. So if online store has physical store, use pick up wisely. I have purchased several parts on <a href="http://http://www.ncix.com/" target="_blank" rel="noopener">NCIX</a> and <a href="http://www.canadacomputers.com" target="_blank" rel="noopener">Canada Computer</a> just to save the shipping fee. Even more, both also provide price match, which make them more affordable.</p>
<p>Amazon also has great deals eventually, but due to the currency exchange rate Amazon Canada alway have match higher price regardless of the physical distant is so close. Therefore, using Amazon US is also a good option if living near the boarder. Sometime, even including the import fee purchasing from Amazon US, the price is still cheaper than in Canada. What a life Canadian is!</p>
<p>Finally, wait holiday or promotional events. Especially Boxing day, you could get the best price. However, normally the quantity are limit. One of my friends bought he loved GPU by lining up at 5am in front of the store.</p>
<h2 id="Build-up"><a href="#Build-up" class="headerlink" title="Build up"></a>Build up</h2><p>It is usually easy to assembly the parts (just follow the manual), however, my build is a little bit special that have three radiators – one for CPU, two for GPU. Not many people using dual GPU with AIO liquid radiators, which makes there is no much info online to help me choose the right case.  </p>
<p>After googling, I conclude the Define S could be the best fit for my needs. But I was only half right. Define S is well designed for water cooling system, and beautiful out look. I’m definitely satisfied with the choice. However, the case is a little bit wider to put the GPU AIO radiator on the front panel.</p>
<p><img src="/img/diy_pc_3.jpg" alt="Building the pc"></p>
<p>As the above pic shows, I have no options to put the radiator into the tiny space beside PSU. Here is the part I love Define S, it supports the bottom fan and saves my day. Otherwise, I would have to disassemble all parts and exchange another case, then do it again.</p>
<p>At the bottom front panel, another fan is installed to pull air in to provide positive air pressure. The air flow inside the case illustrates in the following pic:</p>
<p><img src="/img/diy_pc_4.jpg" alt="Airflow in PC case"></p>
<h2 id="All-in-all"><a href="#All-in-all" class="headerlink" title="All in all"></a>All in all</h2><p>After a day and a night, the PC finally up and run. Here is some conclusions I learned:</p>
<ol>
<li>Patient while purchasing. There is alway a deal waiting to be discovered. However, the price also could infinitely low, watch the history price, it only could be at the lowest at a certain point, after that the price remain the normal or the item discontinued.</li>
<li>Case is as important as GPU and CPU. A good case can save a day.</li>
<li>Modular PSU is clean and simple. My build could become true is not only because the case is great, but also the modular PSU save much space for the radiator.</li>
</ol>
<p>Here is the complete shot:</p>
<p><img src="/img/diy_pc_2.jpg" alt="Completed PC"> </p>
<p><strong>Update(2017-Aug-14)</strong>: I also bought an M.2 SSD to install the Ubuntu OS, as the most machine learning algorithms are build upon Linux system. Moreover, the driver officially provided for the Asus USB-AC51 is not compatible for Ubuntu 16.04 LTS (I also tried several customized drivers, they may fit the 14.04 LTS but not the 16.04). So be careful when purchase the USB Wifi adapter, here is a <a href="http://willhaley.com/blog/linux-16-04-1-usb-wifi-adapters/" target="_blank" rel="noopener">list</a> that has some “work out of box” USB for Ubuntu 16.04 and above.</p>
<p><strong>Update(2019-Jun-24)</strong>: Recently bought another M.2 SSD for share disk between Ubuntu and Windows. Due to recently SSD price drop, the 960G SSD only cost $150 (included tax). Even cheaper and faster than 500G SATA SSD I bought 2 years ago. How technology changes so fast! To mount the new SSD in Ubuntu, I followed the top answer in the StackOverflow <a href="https://askubuntu.com/a/125277" target="_blank" rel="noopener">post</a>.</p>
]]></content>
      
        <categories>
            
            <category> DIY </category>
            
        </categories>
        
        
        <tags>
            
            <tag> SLI </tag>
            
            <tag> Water Cooling </tag>
            
            <tag> Deep Learning </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Auto Sync Github Forked Repos]]></title>
      <url>https://en.abnerchou.me/Blog/562ef8f1/</url>
      <content type="html"><![CDATA[<p>As a Github heavy user, when I saw an interested repos, I would fork them to my “secret” organization to read/use in future. However, when checked them later, most of the time (99%), the repos have already out of synced. There are three options I normally choose:</p>
<ol>
<li>delete the forked repo and re-fork;</li>
<li>manually merge to the latest commit;</li>
<li>use the PR and switch the source and destination (<a href="https://stackoverflow.com/a/23853061" target="_blank" rel="noopener">ref</a>).</li>
</ol>
<a id="more"></a>
<p>Although those three options works like a “charm” in a small amount of repos, it’s more like chores when maintaining hundreds forked repos.</p>
<h3 id="TL-DR"><a href="#TL-DR" class="headerlink" title="TL;DR"></a>TL;DR</h3><p>Then I came up the idea to use Travis-CI to sync those repos automatically. The mechanism is simple and straightforward, which runs a script periodically to update forked repos with source repos. The script could be bash, javascript, python, or any language which could call git command in the Linux OS.</p>
<h3 id="My-Approach"><a href="#My-Approach" class="headerlink" title="My Approach"></a>My Approach</h3><p>Based on the above idea, I wrote a <a href="https://github.com/NoahDragon/update-forked-repo" target="_blank" rel="noopener">js script</a> to do the job. But this script is only a solution my problems:</p>
<ul>
<li>Only works on forked repos in a Github Org.</li>
<li>Forked repos should never be modified. </li>
<li>User Github personal token to access.</li>
<li>Not support private repos.</li>
</ul>
<p>If your needs also match the aboves, then simple fork my script, and modify the <code>org</code> in <code>.config.yml</code>.</p>
]]></content>
      
        <categories>
            
            <category> DevOps </category>
            
        </categories>
        
        
        <tags>
            
            <tag> travis-ci </tag>
            
            <tag> Github </tag>
            
            <tag> nodejs </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Build SSL HTTPS Website Using Docker]]></title>
      <url>https://en.abnerchou.me/Blog/75027340/</url>
      <content type="html"><![CDATA[<p><img src="\img\https.png" alt="https"></p>
<p>When you’re visiting my website, you may not see the https in the URL, which means you have been directed to a CDN node other than my VPS server. This doesn’t mean the method doesn’t work. Anyway, let’s begin the talk.</p>
<p>The purpose of this post is to help people to avoid the pitfalls that I encountered, and severs as a note for future reference.</p>
<a id="more"></a>
<h3 id="Prerequisites"><a href="#Prerequisites" class="headerlink" title="Prerequisites"></a>Prerequisites</h3><ul>
<li>All my setup is on Ubuntu 16.04, and may not suitable for other version/OS.</li>
<li><a href="https://docs.docker.com/engine/installation/" target="_blank" rel="noopener">Docker</a> must be installed and properly functioning.</li>
<li><a href="https://docs.docker.com/compose/install/" target="_blank" rel="noopener">Docker compose</a> is an option, but this article only showing the method that is using docker compose, which is simpler than using docker alone.</li>
<li>Any machine/VPS/cloud server that you have root control, like <a href="https://m.do.co/c/eaf9c533bc55" target="_blank" rel="noopener">Digital Ocean</a>[Get $10 with coupon code <code>ACTIVATE10</code>], <a href="http://www.vultr.com/?ref=7025798" target="_blank" rel="noopener">Vultr</a>[Get $50 (expired after 6 months) with coupon code <code>DOMORE</code> ], <a href="https://www.linode.com/?r=31b7ad9bbcdac84ed780e48344212c99afcaa3d2" target="_blank" rel="noopener">Lindo</a>[Get $20 with coupon code <code>PodcastInIt20</code>], and etc.</li>
<li>DNS already points to your machine, and all domains which would like to support Https also have CNAME or A record.</li>
<li>Git is also an option, unless you would like to build the image on your own.</li>
</ul>
<h3 id="Set-Up"><a href="#Set-Up" class="headerlink" title="Set Up"></a>Set Up</h3><p>Only two docker images are used:</p>
<ul>
<li><a href="https://github.com/bringnow/docker-letsencrypt-manager" target="_blank" rel="noopener">Docker-letsencrypt-manager</a></li>
<li><a href="https://github.com/bringnow/docker-nginx-letsencrypt" target="_blank" rel="noopener">Docker-nginx-letsencrypt</a></li>
</ul>
<p>The niginx server has to start up before running the letsencrypt, because the letsencrypt needs to access the server to finish the generating certificate process.</p>
<h4 id="docker-compose-yml-for-nignx"><a href="#docker-compose-yml-for-nignx" class="headerlink" title="docker-compose.yml for nignx"></a>docker-compose.yml for nignx</h4><p>Create <code>docker-compose.yml</code> and paste the following into it.</p>
<pre class=" language-yaml"><code class="language-yaml"><span class="token key atrule">nginx</span><span class="token punctuation">:</span>
  <span class="token key atrule">image</span><span class="token punctuation">:</span> bringnow/nginx<span class="token punctuation">-</span>letsencrypt
  <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> ./nginx.conf<span class="token punctuation">:</span>/etc/nginx/nginx.conf
    <span class="token punctuation">-</span> /etc/letsencrypt<span class="token punctuation">:</span>/etc/letsencrypt
    <span class="token punctuation">-</span> /var/acme<span class="token punctuation">-</span>webroot<span class="token punctuation">:</span>/var/acme<span class="token punctuation">-</span>webroot
    <span class="token punctuation">-</span> /srv/docker/nginx/dhparam<span class="token punctuation">:</span>/etc/nginx/dhparam
  <span class="token key atrule">ports</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token string">"80:80"</span>
    <span class="token punctuation">-</span> <span class="token string">"443:443"</span>
  <span class="token key atrule">net</span><span class="token punctuation">:</span> <span class="token string">"host"</span>
  <span class="token key atrule">dns_search</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token string">"example.com"</span>
</code></pre>
<p>Modify it accordingly to fit your environment.</p>
<h4 id="Generate-dhparam"><a href="#Generate-dhparam" class="headerlink" title="Generate dhparam"></a>Generate dhparam</h4><p>Although the nginx docker will create DH parameters on initial start up, it is time comsuming to generate the 4096 bit DH parameters (more than an hour on my VPS). Run the following command and copy the generated file to the <code>/srv/docker/nginx/dhparam</code> folder (set in docker-compose.yml).</p>
<pre class=" language-bash"><code class="language-bash">openssl dhparam -out RSA4096.pem -5 4096
</code></pre>
<h4 id="Create-Nginx-Config-file"><a href="#Create-Nginx-Config-file" class="headerlink" title="Create Nginx Config file"></a>Create Nginx Config file</h4><p>In order to complete the letsencrypt challenge, the server has to open the 80 port. The nginx-letsencrypt image already come with the setting snippets: <code>snippets/letsencryptauth.conf</code> and <code>snippets/sslconfig.conf</code>.</p>
<p>Here is the sample config file:</p>
<pre class=" language-nginx"><code class="language-nginx"><span class="token keyword">events</span> <span class="token punctuation">{</span>
  <span class="token keyword">worker_connections</span> <span class="token number">1024</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">http</span> <span class="token punctuation">{</span>

  <span class="token keyword">include</span> snippets<span class="token operator">/</span>letsencryptauth<span class="token punctuation">.</span>conf<span class="token punctuation">;</span>
  <span class="token keyword">include</span> snippets<span class="token operator">/</span>sslconfig<span class="token punctuation">.</span>conf<span class="token punctuation">;</span>

  <span class="token keyword">server</span> <span class="token punctuation">{</span>
    <span class="token keyword">listen</span> <span class="token number">443</span> <span class="token keyword">ssl</span> default_server<span class="token punctuation">;</span>
    <span class="token keyword">server_name</span> example<span class="token punctuation">.</span>com www<span class="token punctuation">.</span>example<span class="token punctuation">.</span>com

    <span class="token keyword">ssl_certificate</span> <span class="token operator">/</span>etc<span class="token operator">/</span>letsencrypt<span class="token operator">/</span>live<span class="token operator">/</span>www<span class="token punctuation">.</span>example<span class="token punctuation">.</span>com<span class="token operator">/</span>fullchain<span class="token punctuation">.</span>pem<span class="token punctuation">;</span>
    <span class="token keyword">ssl_certificate_key</span> <span class="token operator">/</span>etc<span class="token operator">/</span>letsencrypt<span class="token operator">/</span>live<span class="token operator">/</span>www<span class="token punctuation">.</span>example<span class="token punctuation">.</span>com<span class="token operator">/</span>privkey<span class="token punctuation">.</span>pem<span class="token punctuation">;</span>

    <span class="token keyword">add_header</span> Strict<span class="token operator">-</span>Transport<span class="token operator">-</span>Security <span class="token string">"max-age=31536000; includeSubdomains"</span> always<span class="token punctuation">;</span>

    <span class="token keyword">location</span> <span class="token operator">/</span> <span class="token punctuation">{</span>
      <span class="token comment" spellcheck="true"># Just return a blank response</span>
      <span class="token keyword">return</span> <span class="token number">200</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p><strong>NOTE</strong>: Please comment out those two lines start up ssl_certificate before the certificate generated.</p>
<h4 id="Make-Nginx-Online"><a href="#Make-Nginx-Online" class="headerlink" title="Make Nginx Online"></a>Make Nginx Online</h4><p>Now run the following command to bring Nginx online:</p>
<pre class=" language-bash"><code class="language-bash">docker-compose up -d
</code></pre>
<p>To confim if the docker is running correctly, we could look the log file to check:</p>
<pre class=" language-bash"><code class="language-bash">docker-compose logs
</code></pre>
<p>If there are some error messages, please check the Nginx config file and restart the docker.</p>
<h4 id="docker-compose-yml-for-letsencrypt"><a href="#docker-compose-yml-for-letsencrypt" class="headerlink" title="docker-compose.yml for letsencrypt"></a>docker-compose.yml for letsencrypt</h4><p>In another folder, create a docker-compose.yml:</p>
<pre class=" language-yaml"><code class="language-yaml"><span class="token key atrule">cli</span><span class="token punctuation">:</span>
  <span class="token key atrule">image</span><span class="token punctuation">:</span> bringnow/letsencrypt<span class="token punctuation">-</span>manager<span class="token punctuation">:</span>latest
  <span class="token key atrule">env_file</span><span class="token punctuation">:</span> config.env
  <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> /etc/letsencrypt<span class="token punctuation">:</span>/etc/letsencrypt
    <span class="token punctuation">-</span> /var/lib/letsencrypt<span class="token punctuation">:</span>/var/lib/letsencrypt
    <span class="token punctuation">-</span> /var/acme<span class="token punctuation">-</span>webroot<span class="token punctuation">:</span>/var/acme<span class="token punctuation">-</span>webroot

<span class="token key atrule">cron</span><span class="token punctuation">:</span>
  <span class="token key atrule">image</span><span class="token punctuation">:</span> bringnow/letsencrypt<span class="token punctuation">-</span>manager<span class="token punctuation">:</span>latest
  <span class="token key atrule">env_file</span><span class="token punctuation">:</span> config.env
  <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> /etc/letsencrypt<span class="token punctuation">:</span>/etc/letsencrypt
    <span class="token punctuation">-</span> /var/lib/letsencrypt<span class="token punctuation">:</span>/var/lib/letsencrypt
    <span class="token punctuation">-</span> /var/acme<span class="token punctuation">-</span>webroot<span class="token punctuation">:</span>/var/acme<span class="token punctuation">-</span>webroot
  <span class="token key atrule">command</span><span class="token punctuation">:</span> cron<span class="token punctuation">-</span>auto<span class="token punctuation">-</span>renewal
  <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
</code></pre>
<p>Modify it accordingly. Make sure the folder <code>/var/lib/letsencrypt</code> and <code>/var/acme-webroot</code> have created and exist.</p>
<p>Then create config.env file in the same folder and input your email:</p>
<pre class=" language-bash"><code class="language-bash">LE_EMAIL<span class="token operator">=</span>
LE_RSA_KEY_SIZE<span class="token operator">=</span>4096
</code></pre>
<h4 id="Generate-SSL-Certificate"><a href="#Generate-SSL-Certificate" class="headerlink" title="Generate SSL Certificate"></a>Generate SSL Certificate</h4><p>Finally, we could create our Https certificate. Run the commands:</p>
<pre class=" language-bash"><code class="language-bash">docker-compose run cli add <span class="token operator">&lt;</span>domain<span class="token operator">></span> <span class="token punctuation">[</span>alternative domains<span class="token punctuation">]</span>
</code></pre>
<p>If it fails, please check if Nginx is runing and the DNS setting is correct.</p>
<p><strong>NOTE</strong>: If the certificate generate, don’t forget to remove comment on ssl_certificate lines in Nginx config file, and restart it.</p>
<h3 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h3><p>Now your website should up and running with https. Enjoy.</p>
<p>~ EOF ~</p>
]]></content>
      
        <categories>
            
            <category> DevOps </category>
            
        </categories>
        
        
        <tags>
            
            <tag> HTTPS </tag>
            
            <tag> SSL </tag>
            
            <tag> Nginx </tag>
            
            <tag> Docker </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Hexo Top 10 Popular Themes]]></title>
      <url>https://en.abnerchou.me/Blog/5c00ca67/</url>
      <content type="html"><![CDATA[<p><img src="\img\hexo-logo.png" alt=""></p>
<p><a href="https://hexo.io/" target="_blank" rel="noopener">Hexojs</a> is one of the most popular static site generator based on <a href="https://nodejs.org/en/" target="_blank" rel="noopener">nodejs</a> [<a href="https://www.staticgen.com/" target="_blank" rel="noopener">ref</a>].</p>
<p>There are around 75 themes list on the <a href="https://hexo.io/themes/" target="_blank" rel="noopener">website</a>, here is the top 10 popular ones. </p>
<a id="more"></a>
<h2 id="NexT"><a href="#NexT" class="headerlink" title=" NexT"></a><img class="nofancybox" src="/img/top1.png" style="display: inline; border-style: none;"> NexT</h2><div style="text-align:center">
  <div class="github-card" data-user="iissnan" data-repo="hexo-theme-next" data-width="400" data-theme="medium" data-target="" data-client-id="" data-client-secret=""></div>
</div>
<script src="/github-card-lib/githubcard.js"></script>

<p>#responsive  #one_column  #clean  #white</p>
<h2 id="Yilia"><a href="#Yilia" class="headerlink" title=" Yilia"></a><img class="nofancybox" src="/img/top2.png" style="display: inline; border-style: none;"> Yilia</h2><div style="text-align:center">
  <div class="github-card" data-user="litten" data-repo="hexo-theme-yilia" data-width="400" data-theme="medium" data-target="" data-client-id="" data-client-secret=""></div>
</div>
<script src="/github-card-lib/githubcard.js"></script>

<p>#responsive  #elegant  #sidebar  #two_column  #one_column</p>
<h2 id="Material"><a href="#Material" class="headerlink" title=" Material"></a><img class="nofancybox" src="/img/top3.png" style="display: inline; border-style: none;"> Material</h2><div style="text-align:center">
  <div class="github-card" data-user="viosey" data-repo="hexo-theme-material" data-width="400" data-theme="medium" data-target="" data-client-id="" data-client-secret=""></div>
</div>
<script src="/github-card-lib/githubcard.js"></script>

<p>#responsive  #simple  #material_design  #blog  #multi_styles  #minimalism  #i18n  #elegant  #material  #one_column</p>
<h2 id="Tranquilpeek"><a href="#Tranquilpeek" class="headerlink" title="Tranquilpeek"></a>Tranquilpeek</h2><div style="text-align:center">
  <div class="github-card" data-user="LouisBarranqueiro" data-repo="tranquilpeak-hexo-theme" data-width="400" data-theme="default" data-target="" data-client-id="" data-client-secret=""></div>
</div>
<script src="/github-card-lib/githubcard.js"></script>

<p>#responsive  #gorgeous  #sidebar  #two_column  #one_column  #tag_plugins</p>
<h2 id="Maupassant"><a href="#Maupassant" class="headerlink" title="Maupassant"></a>Maupassant</h2><div style="text-align:center">
  <div class="github-card" data-user="tufu9441" data-repo="maupassant-hexo" data-width="400" data-theme="default" data-target="" data-client-id="" data-client-secret=""></div>
</div>
<script src="/github-card-lib/githubcard.js"></script>

<p>#simple  #responsive  #two_column  #white  #jade  #scss</p>
<h2 id="Yelee"><a href="#Yelee" class="headerlink" title="Yelee"></a>Yelee</h2><div style="text-align:center">
  <div class="github-card" data-user="MOxFIVE" data-repo="hexo-theme-yelee" data-width="400" data-theme="default" data-target="" data-client-id="" data-client-secret=""></div>
</div>
<script src="/github-card-lib/githubcard.js"></script>

<p>#responsive  #two_column  #toc  #elegant  #simple  #background_image</p>
<h2 id="Apollo"><a href="#Apollo" class="headerlink" title="Apollo"></a>Apollo</h2><div style="text-align:center">
  <div class="github-card" data-user="pinggod" data-repo="hexo-theme-apollo" data-width="400" data-theme="default" data-target="" data-client-id="" data-client-secret=""></div>
</div>
<script src="/github-card-lib/githubcard.js"></script>

<p>#chinese  #light</p>
<h2 id="Icarus"><a href="#Icarus" class="headerlink" title="Icarus"></a>Icarus</h2><div style="text-align:center">
  <div class="github-card" data-user="ppoffice" data-repo="hexo-theme-icarus" data-width="400" data-theme="default" data-target="" data-client-id="" data-client-secret=""></div>
</div>
<script src="/github-card-lib/githubcard.js"></script>

<p>#responsive  #three_column  #clean  #flat  #light</p>
<h2 id="Jacman"><a href="#Jacman" class="headerlink" title="Jacman"></a>Jacman</h2><div style="text-align:center">
  <div class="github-card" data-user="wuchong" data-repo="jacman" data-width="400" data-theme="default" data-target="" data-client-id="" data-client-secret=""></div>
</div>
<script src="/github-card-lib/githubcard.js"></script>
 
<p>#responsive  #two_column  #blue  #elegant</p>
<h2 id="Fexo"><a href="#Fexo" class="headerlink" title="Fexo"></a>Fexo</h2><div style="text-align:center">
  <div class="github-card" data-user="forsigner" data-repo="fexo" data-width="400" data-theme="default" data-target="" data-client-id="" data-client-secret=""></div>
</div>
<script src="/github-card-lib/githubcard.js"></script>

<p>#responsive #simple #elegant</p>
<p>~ EOF ~</p>
<p>Updated: 2016-Dec-06</p>
<p>For real time rank please visit the following link: <a href="https://github.com/search?o=desc&amp;q=hexo-theme&amp;s=stars&amp;type=Repositories&amp;utf8=%E2%9C%93" target="_blank" rel="noopener">Github Search</a></p>
<p>Updated: 2017-Apr-17</p>
<p>The material theme is really a black sheep. It jumps from #9 to #3 since last update, and it even didn’t exist when this post created.</p>
<p>Here is a performance compare among top three Hexo themes (this may explain why material is so popular):</p>
<p><img src="/img/top-theme-compare.jpg" alt="Material NexT Yilia Performance"></p>
<p>Image from <a href="http://weibo.com/645030234?refer_flag=1005055010_&amp;is_hot=1" target="_blank" rel="noopener">Weibo</a>.</p>
]]></content>
      
        <categories>
            
            <category> Blog </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> Theme </tag>
            
            <tag> Blog </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Goodby Microsoft TechReward]]></title>
      <url>https://en.abnerchou.me/Blog/8aae6eef/</url>
      <content type="html"><![CDATA[<p><img src="\img\ms_tech_reward.jpg" alt=""></p>
<p>The Microsoft TechRewards Program will close on January 6, 2017. (<a href="https://rewards.msdn.microsoft.com/en-us/signin" target="_blank" rel="noopener">ref</a>) All challenges have cleaned up now (Oct-06-2016).</p>
<p>Really don’t have any hard feeling about this. The only reward attracted me was the AppToCerts, which rewarded you the MS certificate if passed two challenges. Other than it, to achieve a $2 reward, you have to complete at least 3 challenges, and the rewards are all donations.</p>
<p>So here I will list the reasons why I think it is going to fail:</p>
<a id="more"></a>
<h3 id="Low-Profit-Rewards"><a href="#Low-Profit-Rewards" class="headerlink" title="Low Profit Rewards"></a>Low Profit Rewards</h3><p>For some usable rewards, like Skype credit, you have to complete more than 10 challenges, and each challenges takes around half hour to finish. Five hours for a $25 USD, it even not matches the basic salaries.</p>
<h3 id="Outdated-instruction"><a href="#Outdated-instruction" class="headerlink" title="Outdated instruction"></a>Outdated instruction</h3><p>I followed instruction to complete a challenge, which takes around an hour to fix an issue because of the wrong description. The challenge is re-listed each month, but no one tries to correct it.</p>
<h3 id="Slow-website-performance"><a href="#Slow-website-performance" class="headerlink" title="Slow website performance"></a>Slow website performance</h3><p>The layout of website likes 5 years ago, and felt lagged when loading content.</p>
<h3 id="Lack-of-Popular-Techniques"><a href="#Lack-of-Popular-Techniques" class="headerlink" title="Lack of Popular Techniques"></a>Lack of Popular Techniques</h3><p>Microsoft wants to advertise its own products (C#, WPF, ect.), so there is rarely Java/Ruby/Python challenges (I couldn’t say no because I don’t use it very often). </p>
<h3 id="Not-Fun-at-All"><a href="#Not-Fun-at-All" class="headerlink" title="Not Fun at All"></a>Not Fun at All</h3><p>Every challenges like ADs, promoting Microsoft latest tools or techniques, but not fun at all. It likes reading a textbook while go through its description.</p>
<h3 id="No-Feedback"><a href="#No-Feedback" class="headerlink" title="No Feedback"></a>No Feedback</h3><p>If follows the instruction, most of the challenges will be passed, however, if it failed, you couldn’t get any feedbacks to point out the problems. You even couldn’t retry the challenge. </p>
<h3 id="Redundant-Challenges"><a href="#Redundant-Challenges" class="headerlink" title="Redundant Challenges"></a>Redundant Challenges</h3><p>Because the challenges re-list every month, and not a lot of new ones added. Moreover, you couldn’t retake any challenges no matter you passed or failed. Although the challenges repeated each month, for people who take them, those are redundant.</p>
<p>All in all, goodbye Microsoft TechRewards.</p>
<p>~ EOF ~</p>
]]></content>
      
        <categories>
            
            <category> News </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Microsoft </tag>
            
            <tag> TechReward </tag>
            
            <tag> Exam </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Set up HTTPS Free]]></title>
      <url>https://en.abnerchou.me/Blog/daa790/</url>
      <content type="html"><![CDATA[<p><img src="\img\https_5.png" alt=""></p>
<p>Nowadays, it is easy to get an TLS certificate to create HTTPS website (<a href="https://letsencrypt.org/" target="_blank" rel="noopener">Ref</a>), but it requires the full control of server and configuration to maintain. However, for the casual user, like me this blog, I host my content on a third party server (Github Pages), which strictly forbids to customize server settings. To bypass those limits on server side, we need a middle layer to control all traffics, the Cloudflare is the best tool.</p>
<a id="more"></a>
<h2 id="Backgrounds"><a href="#Backgrounds" class="headerlink" title="Backgrounds"></a>Backgrounds</h2><p><a href="https://github.com/" target="_blank" rel="noopener">Github</a> provides a service called Github Pages, which allows user to create static content on Github server and access via username.github.io. However, it does not support https for custom domains, and the cache age is only 10 mins and can not be adjusted.</p>
<p><a href="https://www.cloudflare.com/" target="_blank" rel="noopener">Cloudflare</a> is a DNS and CDN provider. All the basic services are free of charge, and they are already good enough for a static website.</p>
<p><a href="https://en.wikipedia.org/wiki/HTTPS" target="_blank" rel="noopener">HTTPS</a> is a web portal, which also called HTTP over TLS. It provides secure connect between server and client. To enable this on your server, you have to purchase a certificate from a TLS provider (<strong>not cheap</strong>), and set up it for your domain (<strong>not easy</strong>). One important reason to use HTTPS other than security is speed, that firewalls would skip checking the contents send via HTTPS, hence HTTPS normally faster than HTTP in most scenarios (see <a href="https://www.httpvshttps.com/" target="_blank" rel="noopener">http vs https</a>).</p>
<p><a href="https://en.wikipedia.org/wiki/HTTP_Strict_Transport_Security" target="_blank" rel="noopener">HSTS</a> helps your website more secure. It strictly forbids the HTTP connection on your website, if your website displays a content from a HTTP link, the browser will refuse to load. So before set your site up and run with HTTPS and eliminate mix contents, do not turn it on.</p>
<h2 id="Prerequisites"><a href="#Prerequisites" class="headerlink" title="Prerequisites"></a>Prerequisites</h2><h3 id="Settings-on-Github"><a href="#Settings-on-Github" class="headerlink" title="Settings on Github"></a>Settings on Github</h3><p>Set up an Github Pages, add CNAME to the root folder. Here is the <a href="https://help.github.com/articles/using-a-custom-domain-with-github-pages/" target="_blank" rel="noopener">guide</a> for using custom domain with Github pages.</p>
<h3 id="Settings-on-Cloudflare"><a href="#Settings-on-Cloudflare" class="headerlink" title="Settings on Cloudflare"></a>Settings on Cloudflare</h3><p>First, you have to set up the Cloudflare as your DNS manager. It basically tells the domain provider that DNS is handled by Cloudflare. You can google to find a tutorial about it.</p>
<p>Then, connect to Github page. Just setting the A and CNAME records on DNS.</p>
<h3 id="Test-if-Cloudflare-is-working"><a href="#Test-if-Cloudflare-is-working" class="headerlink" title="Test if Cloudflare is working"></a>Test if Cloudflare is working</h3><p>Type the following code in your console (replace theurloftheresource to the actual url)</p>
<pre class=" language-bash"><code class="language-bash">curl -svo /dev/null http://theurloftheresource
</code></pre>
<p>If the return shows something like CF-Cache-Status: HIT, that means your pages have cached on Cloudflare (<a href="https://support.cloudflare.com/hc/en-us/articles/200169556-How-can-I-tell-if-CloudFlare-is-caching-my-site-or-a-specific-file-" target="_blank" rel="noopener">Ref</a>).</p>
<h2 id="Set-up-HTTPS-and-Page-Rules"><a href="#Set-up-HTTPS-and-Page-Rules" class="headerlink" title="Set up HTTPS and Page Rules"></a>Set up HTTPS and Page Rules</h2><p>To enable the HTTPS is simple, just need to turn on the Crypto. Here we choose flexible. The full and full(strict) will also connect server (github pages) via HTTPS, which is not possible.</p>
<p><img src="/img/https_1.png" alt=""></p>
<p>To turn on the HSTS is as easy as the HTTPS, just click the icon. But you have to click accept to indicate that you acknowledge this setting may break your site if not be set properly. To avoid the risk, we’d better set up the page rules before turn it on.</p>
<p>There are three basic checks (at least) to turn on the HSTS:</p>
<ul>
<li>Always connected via HTTPS</li>
<li><a href="http://domain.com" target="_blank" rel="noopener">http://domain.com</a> need to redirect to <a href="https://domain.com" target="_blank" rel="noopener">https://domain.com</a></li>
<li><a href="http://domain.com" target="_blank" rel="noopener">http://domain.com</a> can’t redirect to <a href="https://www.domain.com" target="_blank" rel="noopener">https://www.domain.com</a></li>
</ul>
<p>To pass those checks, we only need two page rules (Cloudflare free plan can set maximum three page rules). The first it always using HTTPS, and the second is forwarding URL. Note, the order matters.</p>
<p><img src="/img/https_2.png" alt=""></p>
<p>Now enable the HSTS, and then open the <a href="https://hstspreload.appspot.com/" target="_blank" rel="noopener">Chrome preload list</a>, and submit your domain. It should succeed, and shows the following message.</p>
<p><img src="/img/https_3.png" alt=""></p>
<p>Everything is set and your website will always be connected through the secure protocol.</p>
<h2 id="Extra-Page-Rule-Usage"><a href="#Extra-Page-Rule-Usage" class="headerlink" title="Extra Page Rule Usage"></a>Extra Page Rule Usage</h2><p>As we have one more page rule left, you could leave it as blank. But as stated above, the github pages set the Cache-Control: max-age=600, which is 10 mins. That means every 10 mins the user has to fetch data through github page, no matter it changed or not. This is really inefficiency. To overwrite this setting, we could set the browser cache TTL. I set it to one year, because my assets would rarely be modified.</p>
<p><img src="/img/https_4.png" alt=""></p>
<p>Moreover, there is another setting that could power up the static website. It is the edge cache TTL, which set the time length that Cloudflare will hold your content caches. For example, if we set it to 2 hours, which means every 2 hours Cloudflare has to fetch data from origin server. Since our static websites do not change a lot, we could set to one month.</p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>The settings for Cloudflare is generic, that means you can use it to set up HTTPS on any kind of server free.</p>
<p>Cloudflare has plenty powerful services, if using them wisely, can save your life for managing a website.</p>
<p>Enjoy your secure and faster website!</p>
]]></content>
      
        <categories>
            
            <category> Server </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Github </tag>
            
            <tag> HTTPS </tag>
            
            <tag> Cloudflare </tag>
            
            <tag> Website </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Coding Play and Learn]]></title>
      <url>https://en.abnerchou.me/Blog/2db6c020/</url>
      <content type="html"><![CDATA[<p><img src="/img/play_learn_head.jpg" alt=""></p>
<p>I have been planing to come up a list of games that teach people to program. Luckily with the chance got requested to answer on <a href="https://www.quora.com/Whats-a-good-way-to-learn-how-to-code-very-easily" target="_blank" rel="noopener">Quora</a>, I spent some time to organize the list.</p>
<a id="more"></a>
<p>Here are several sites that allow you to using coding to play.</p>
<p><img src="/img/play_learn_code_combat.jpeg" alt=""></p>
<p><a href="https://codecombat.com/" target="_blank" rel="noopener">CodeCombat</a> is an RPG game which you could use Javascript, Coffeescript, Lua, Python, Clojure, and Io.</p>
<p><img src="/img/play_learn_code_hunt.png" alt=""></p>
<p><a href="https://www.codehunt.com/" target="_blank" rel="noopener">Code Hunt</a> is developed by Microsoft Research. In which, you are a code hunter to find the bug in C#/Java code.</p>
<p><img src="/img/play_learn_codingame.jpg" alt=""></p>
<p><a href="https://www.codingame.com/start" target="_blank" rel="noopener">CodinGame</a> I haven’t played it yet, but it looks fun.</p>
<p><img src="/img/play_learn_creeps.jpg" alt=""></p>
<p><a href="https://screeps.com/" target="_blank" rel="noopener">Screeps</a> is an online RTS. You have to build up your territory, and defend it from AI and other player’s attach. For now, it only support the Javascript, and you have to pay2play.</p>
<p><a href="http://fightcodegame.com/" target="_blank" rel="noopener">FightCode</a> Build your smart tank and beat others. It’s really similar to <a href="http://robocode.sourceforge.net/" target="_blank" rel="noopener">Robocode</a>.</p>
<p><a href="http://play.elevatorsaga.com/" target="_blank" rel="noopener">Elevator Saga</a> You become an elevator operator. You have to deliver certain number of people within a time frame to pass to next level.</p>
<p><a href="https://www.battlecode.org/" target="_blank" rel="noopener">Battle Code</a> Not know much about it, but it holds contest for students.</p>
<p><a href="https://www.bloc.io/ruby-warrior/#/warriors" target="_blank" rel="noopener">Ruby Warrior</a> Learn Ruby and beat dungeon.</p>
<p><a href="https://scratch.mit.edu/" target="_blank" rel="noopener">Scratch</a> Visually coding.</p>
<p><a href="https://lightbot.com/" target="_blank" rel="noopener">LightBot</a> Simple game which teachs the basic function and loop concepts.</p>
<p><a href="http://flexboxfroggy.com/" target="_blank" rel="noopener">FlexBox Froggy</a> Learn CSS FlexBox through games.</p>
<p><a href="https://halite.io/" target="_blank" rel="noopener">Halite</a> Artificial Intelligence chanllenge game. </p>
<p><img src="/img/cryptozombies.jpeg" alt="Crypto Zombies"></p>
<p><a href="https://cryptozombies.io/" target="_blank" rel="noopener">CryptoZombies</a> is an interactive code school that teaches you to write smart contracts in Solidity through building your own crypto-collectables game.</p>
<p><img src="https://bot.land/dist/logo.png" alt="Bot Land"></p>
<p><a href="https://bot.land/" target="_blank" rel="noopener">Bot Land</a> is a strategy game by buiding your own robot to fight with other players.</p>
<p>Although these games could not lead you to create applications, they are just good start up. If you found you really enjoy the game, you could pick a programming language to learn it deeper.</p>
]]></content>
      
        <categories>
            
            <category> Game </category>
            
        </categories>
        
        
        <tags>
            
            <tag> code </tag>
            
            <tag> programming </tag>
            
            <tag> games </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[An Online Hacker Game]]></title>
      <url>https://en.abnerchou.me/Blog/e4c9ee8f/</url>
      <content type="html"><![CDATA[<p>You could start the game from <a href="http://fun.coolshell.cn" target="_blank" rel="noopener">here</a>, hosted by <a href="http://coolshell.cn" target="_blank" rel="noopener">coolshell.cn</a>.</p>
<p>Don’t hesitate to use google and wikipedia to solve the puzzles.</p>
<p>I have posted hints and solutions on <a href="https://github.com/NoahDragon/fun.coolshell.cn" target="_blank" rel="noopener">my github</a>, use them wisely when you get difficulties.</p>
<p>Enjoy :)</p>
<p><img src="/img/online_hacker_game.PNG" alt=""></p>
<p>A little bit show off and keep a record.</p>
]]></content>
      
        <categories>
            
            <category> Game </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Hacker game </tag>
            
            <tag> Programming </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Set up VPN with transparent proxy on DigitalOcean]]></title>
      <url>https://en.abnerchou.me/Blog/2b608f65/</url>
      <content type="html"><![CDATA[<p>Recently I just rent a VPS on <a href="https://www.digitalocean.com" target="_blank" rel="noopener">Digital Ocean</a>,
which is cheap for a student and who is price sensitive.
As it gives you all the controls of an OS, it likes a remote compute machine.
Meanwhile, you could do anything as you have your own server.</p>
<a id="more"></a>
<p>Therefore, it comes to my mind to create a VPN server.
VPN is a virtual private network that extends a private network across a public network,
which usually used to bypass firewalls or increase access speed.
Proxy is a server that acts as an intermediary for requests from clients seeking resources from other servers.
It needs to be set in software application’s configuration.
VPN and Proxy both could hide your ip.
The differences between them are listed following:</p>
<table>
<thead>
<tr>
<th style="text-align:left"></th>
<th style="text-align:center">VPN</th>
<th style="text-align:center">Proxy</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Protocols&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
<td style="text-align:center">Support any Protocols</td>
<td style="text-align:center">Support certain Protocols, such as HTTP, SOCKS</td>
</tr>
<tr>
<td style="text-align:left">Softwares</td>
<td style="text-align:center">Any softwares that can run on the machine &nbsp;&nbsp;&nbsp;&nbsp;</td>
<td style="text-align:center">Softwares support proxy configuration</td>
</tr>
<tr>
<td style="text-align:left">Price</td>
<td style="text-align:center">High if you rent from vpn provider</td>
<td style="text-align:center">Low</td>
</tr>
<tr>
<td style="text-align:left">Speed</td>
<td style="text-align:center">Varies depend on number of users<br>usually depends on servers</td>
<td style="text-align:center">Depend on servers</td>
</tr>
<tr>
<td style="text-align:left">Security</td>
<td style="text-align:center">Encryption (128-bit to 2048-bit)</td>
<td style="text-align:center">Not encrypted</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>Because of the encryption, every accesses through VPN retrive the objects directly from the source.
This could slow down the user experience when hits a same object multiple times, such as icons in a webpage.
If there is a way that could cache web objects into VPN server, that will significantly increase the access speed, which get objects from local disk instead of downloading from source website.
Here, I should introduce the transparent proxy, which usually sets on the gateway and caches content from WWW requests.
It calls transparent because client side does not need any configuration.
Hence, every WWW requests through VPN need go to transparent proxy.</p>
<p>This installation guide is tested on Ubuntu 14.04 64bit.
VPN is set up by <a href="http://en.wikipedia.org/wiki/Point-to-Point_Tunneling_Protocol" target="_blank" rel="noopener">pptp</a>.
Transparent proxy is on <a href="http://www.squid-cache.org" target="_blank" rel="noopener">Squid3</a>.</p>
<ul>
<li><strong>pptp installation</strong></li>
</ul>
<p>In terminal, type the command bellow to install pptp server:</p>
<pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> pptpd
</code></pre>
<p>To restrict user access your VPN server, you also need to add users and passwords in <code>/etc/ppp/chap-secets</code>.
In the client column is user’s name, the secret column is for passwords.
I masked mine for privacy.</p>
<p><img src="/img/user_password.jpg" alt=""></p>
<p>Add the following DNS to <code>/etc/ppp/pptpd-options</code>:</p>
<pre class=" language-bash"><code class="language-bash">ms-dns 8.8.8.8
ms-dns 8.8.4.4
</code></pre>
<p>Restart pptp server by command <code>service pptpd restart</code>. Check if it is running by <code>netstat -alpn | grep :1723</code>.</p>
<p>You also should enable the IP forwarding on your pptp server.
This would transfer the package between public ip and private ips on your server.
Open <code>/etc/sysctl.conf</code>, add the following line if not exist: <code>net.ipv4.ip_forward = 1</code>.
Then run <code>sysctl -p</code> to make the change effective.</p>
<p>Create NAT rule for iptables, and your VPN is ready to use:</p>
<pre class=" language-bash"><code class="language-bash">iptables --table nat --append POSTROUTING -o eth0 -j MASQUERADE <span class="token operator">&amp;&amp;</span> iptables-save
</code></pre>
<ul>
<li><strong>Squid3 installation</strong></li>
</ul>
<p>Similar to pptpd, typing the following in terminal:</p>
<pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> squid
update-rc.d squid3 defaults
</code></pre>
<p>The proxy is usable now, but it is the normal proxy with default settings.
To change it to transparent proxy, we need to edit the <code>/etc/squid3/squid.conf</code> file.
The squid.conf follows the rules of allow/deny order.
It obeys the first come first serve, the first matched rule will apply.
For example, if you put “deny all” at the first line of squid.conf, then the proxy denies all request.
If a rule does not indicate in squid.conf, then it defaults as deny.</p>
<p>First, find the line <code>http_port 3128</code>, change it to <code>http_port 3128 transparent</code>.
<strong> this is important </strong></p>
<p>Second, add the following rules:</p>
<pre class=" language-bash"><code class="language-bash">acl myhost src 192.168.0.1
http_access allow myhost
acl mymachine src 10.0.0.0/16
http_access allow mymachine
</code></pre>
<p>The ‘192.168.0.1’ is my public ip, and the ‘10.0.0.0/16’ is my private ips.
Restart squid <code>sudo service squid3 restart</code>.</p>
<p>Finally, we set the iptables to redirect all the traffic through 80 port to 3128 port that is our transparent proxy.</p>
<pre class=" language-bash"><code class="language-bash">iptables -t nat -A PREROUTING -i ppp0 -p tcp -m tcp --dport 80 -j REDIRECT --to-port 3128
</code></pre>
<p>The transparent proxy is set up.</p>
<ul>
<li><strong>Restore iptables rules while system start up</strong></li>
</ul>
<p>Right now, you couldn’t restart the system, otherwise the iptables will be set to empty again.
But you can input the previous iptables commands again to solve this.</p>
<p>Here I introduce a method that will do it once and for all.</p>
<p>Save iptables into <code>/etc/network/iptables.rules</code> by <code>iptables-save &gt; /etc/network/iptables.rules</code></p>
<p>Open <code>/etc/rc.local</code> and add the following line before “exit 0”:</p>
<pre class=" language-bash"><code class="language-bash">/sbin/iptables-restore <span class="token operator">&lt;</span> /etc/network/iptables.rules
</code></pre>
<p>Then our saved iptables rules will be loaded every time the system start up.</p>
<p>Enjoy your VPN server with transparent proxy!</p>
]]></content>
      
        <categories>
            
            <category> Server </category>
            
        </categories>
        
        
        <tags>
            
            <tag> VPN </tag>
            
            <tag> pptp </tag>
            
            <tag> Squid </tag>
            
            <tag> Transparent Proxy </tag>
            
            <tag> Proxy </tag>
            
            <tag> DigitalOcean </tag>
            
            <tag> VPS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Why Sun is the center of our solar system]]></title>
      <url>https://en.abnerchou.me/Blog/e0efd72f/</url>
      <content type="html"><![CDATA[<p>Because our Earth is in a system called Solar System.
I don’t think the answer would be simple as that.
Why the Earth could not be the center?</p>
<p>Actually it could.
As we learn in physic, all motions are relative, like we feel we are still on the Earth, but we actually spin and orbit the Sun.
Moreover, we orbit the Sun, in another words that the Sun also orbits us.
This doesn’t conflict with motion relative law.
But why we are not saying the Sun is orbiting Earth?
<a id="more"></a>
So let’s see how the planets move during heliocentric system and geocentric system.
Here is the link: <a href="http://noahdragon.github.io/SolarSystem.js/" target="_blank" rel="noopener">SolarSystem.js</a>.
You could click to switch the systems, and draw the orbit path for better viewing.</p>
<p>The heliocentric system shows perfect concentric circles of planets path, in contrast, the geocentric system looks like random motion.
Untile we draw their path, only the Sun’s orbit is circle, the other planet tracks are like spiral.
After long enough years, the orbit will look like below picture:</p>
<p><img src="/img/geocentric.jpg" alt=""></p>
<p>It’s totally mess!</p>
<p>This simulated program assumes the planets’ orbit is circle and in the same surface.
In our real solar system, it is way more complicate.</p>
<p>I didn’t do the history research about why heliocentrism won the theory battle.
But I know heliocentrism is better because it is simpler.
This also aligns with the philosophy of Unix/Linux programming:
K.I.S.S., which stands for “Keep It Simple &amp; Straightforward”.</p>
<p>Because of heliocentric system, we make satellite launch possible, and easily calculate the planets position.
Otherwise, I couldn’t image how hard the job is for a mathematician to compute the correct route from the Earth to Mars.</p>
]]></content>
      
        <categories>
            
            <category> Science </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Solar System </tag>
            
            <tag> Javascript </tag>
            
            <tag> Simulation </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[My First Blog Here]]></title>
      <url>https://en.abnerchou.me/Blog/90d363bc/</url>
      <content type="html"><![CDATA[<p>Well, this is my first blog here (right now on github).</p>
<p>I’m using the <a href="http://octopress.org" target="_blank" rel="noopener">Octopress</a> as blog content management,
and I will briefly describe the way to set it up.</p>
<a id="more"></a>
<p>First, go to Octopress <a href="http://octopress.org/docs/setup/" target="_blank" rel="noopener">setup page</a>.
Follow the instruction,
install the dependencies that Octopress will need.</p>
<p>Then choose the platform that the blog will be hosted on,
here is a link for <a href="http://octopress.org/docs/deploying/github/" target="_blank" rel="noopener">deploying github pages</a>.
<strong>Note</strong>: an error occured while I followed the instruction to rake it.</p>
<pre class=" language-bash"><code class="language-bash">rake aborted<span class="token operator">!</span>
You have already activated rake 10.1.0, but your Gemfile requires rake 0.9.6.
Prepending <span class="token variable"><span class="token variable">`</span>bundle <span class="token function">exec</span><span class="token variable">`</span></span> to your <span class="token function">command</span> may solve this.
/Users/Haochen/myBlog/octopress/Rakefile:2:in `<span class="token operator">&lt;</span>top <span class="token punctuation">(</span>required<span class="token punctuation">)</span><span class="token operator">></span>'
<span class="token punctuation">(</span>See full trace by running task with --trace<span class="token punctuation">)</span>
</code></pre>
<p>This error could be easily solved by adding <code>bundle exec</code> in front of the <code>rake</code> command.</p>
<p>After <code>rake generate</code>, go to ‘_deploy’ folder, and type <code>git pull origin master</code>.
Then type <code>rake deploy</code>.
Otherwise, there will be some errors:</p>
<pre class=" language-bash"><code class="language-bash">error: failed to push some refs to <span class="token string">'git@gihub.com:your github page repo'</span>
</code></pre>
<p>Now, your blog page is on-line.
Although the pages are hosted on github,
you still need version control on your Octopress settings,
so don’t forget to commit to the ‘source’ branch.</p>
<pre class=" language-bash"><code class="language-bash"><span class="token function">git</span> add <span class="token keyword">.</span>
<span class="token function">git</span> commit -m <span class="token string">'your message'</span>
<span class="token function">git</span> push origin <span class="token function">source</span>
</code></pre>
<p>I’d rather put them into a bash file git_commit_source.sh, rather than typing every time</p>
<pre class=" language-bash"><code class="language-bash"><span class="token operator">!</span>/bin/bash
<span class="token function">git</span> add <span class="token keyword">.</span> <span class="token operator">&amp;&amp;</span>
<span class="token function">git</span> commit -m <span class="token string">"<span class="token variable">$1</span>"</span> <span class="token operator">&amp;&amp;</span> <span class="token comment" spellcheck="true">#first argument will be the commit message</span>
<span class="token function">git</span> push origin <span class="token function">source</span>
</code></pre>
<p>To generate a blog page, you could use <code>rake new_post[&#39;blog name&#39;]</code>.
However, as I mentioned before the <code>rake</code> command wouldn’t work properly if the ruby version didn’t match.
We could use <code>bundle exec rake</code> to run the command.
Moreover, if you are using <strong>zsh shell</strong>, you should also add <code>noglob</code> in front of these command, because symbol ‘[‘ and ‘]’ are reserved in zsh for regular expression.</p>
<p>Finally, my blog is here.
Much easier than I expected.
Using Octopress can save your time on setting a blog site, and it generates pages automatically.</p>
<p>This blog is still underconstruction. I would like to make it more simple and pretty.
K.I.S.S</p>
<p><strong>Update</strong> (several minutes later):
Encountered a problem of creating single page, e.g. 404.html.
The command <code>rake new-page[&#39;404&#39;]</code> cannot work on zsh due to ‘[]’ is converted.
Hence, the only way to add cutomize page is to write a markdown file and put into ‘source’ fold.
But, do not forget to add the following to the head of page:</p>
<pre class=" language-markdown"><code class="language-markdown"><span class="token hr punctuation">---</span>
layout: page
title: "Super Awesome"
date: 2011-07-03 5:59
comments: true
sharing: true
<span class="token title important">footer: true
<span class="token punctuation">---</span></span>
</code></pre>
<p><strong>Update</strong> (2014-Mar-12):
<code>rake preview</code> has problem with Safari.
Don’t know why but only show blank page while open <a href="http://localhost:4000" target="_blank" rel="noopener">http://localhost:4000</a> .
Using Chrome or Firefox will solve this.[<a href="https://github.com/imathis/octopress/issues/1395" target="_blank" rel="noopener">ref</a>]</p>
<p>Due to save typing, I have written some bash files (deploy.sh and preview.sh):</p>
<pre class=" language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>

bundle <span class="token function">exec</span> rake generate <span class="token operator">&amp;&amp;</span>
bundle <span class="token function">exec</span> rake deploy

</code></pre>
<pre class=" language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>

<span class="token comment" spellcheck="true"># set up the octopress preview</span>
<span class="token comment" spellcheck="true"># open http://localhost:4000 in Chrome</span>
<span class="token comment" spellcheck="true"># Safari has some wired error in it</span>

<span class="token comment" spellcheck="true"># if previous preview is running, stop it</span>
preview_pid<span class="token operator">=</span>`/bin/ps -fu <span class="token variable">$USER</span><span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"rake\ preview"</span> <span class="token operator">|</span> <span class="token function">grep</span> -v <span class="token string">"grep"</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print <span class="token variable">$2</span>}'</span>`
<span class="token function">kill</span> -2 <span class="token variable">$preview_pid</span>

bundle <span class="token function">exec</span> rake generate <span class="token operator">&amp;&amp;</span>
bundle <span class="token function">exec</span> rake preview <span class="token operator">&amp;</span>

<span class="token function">sleep</span> 5 <span class="token comment" spellcheck="true"># wait a while to make sure the preview already running</span>

<span class="token comment" spellcheck="true">#change the browser command if you are using a different OS and browser</span>
/Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome <span class="token string">'http://localhost:4000'</span>

pidof <span class="token string">"Google Chrome"</span> <span class="token operator">|</span> <span class="token function">xargs</span> <span class="token function">wait</span>
preview_pid<span class="token operator">=</span>`/bin/ps -fu <span class="token variable">$USER</span><span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"rake\ preview"</span> <span class="token operator">|</span> <span class="token function">grep</span> -v <span class="token string">"grep"</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print <span class="token variable">$2</span>}'</span>`
<span class="token function">kill</span> -2 <span class="token variable">$preview_pid</span>
<span class="token comment" spellcheck="true">#echo "$preview_pid"</span>
<span class="token keyword">echo</span> <span class="token string">"Preview DONE!"</span>

</code></pre>
<p>Please ignore the text below, the latest code fixes all of them. :P</p>
<p><del><strong>Warnning</strong>:
This preview shell script may not work for you if you are a ruby developer,
or you are using some programs written or depended in/on ruby or ruby packages,
because it killed all ruby processes at the end.
Do not forget to fully quit Chrome (Comman+q in MacOS) before starting a new preview,
otherwise unknown error would occur (duplicate processes).</del></p>
<p><del>BTW, the preview.sh also left a messy terminal for you.
Well, everything have side effects.
But you could add <code>clear</code> command at the end of the script,
if you don’t really care about the traces.</del></p>
]]></content>
      
        <categories>
            
            <category> Blog </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Blog </tag>
            
            <tag> Website </tag>
            
            <tag> General </tag>
            
            <tag> Octopress </tag>
            
        </tags>
        
    </entry>
    
  
  
</search>
